select tstzrange(p) from tbl_period;
                      tstzrange                      
-----------------------------------------------------
 ("2001-01-08 03:08:00+00","2001-01-08 03:11:00+00"]
 ["2001-05-21 15:01:00+00","2001-05-21 15:05:00+00"]
 ["2001-12-28 07:19:00+00","2001-12-28 07:22:00+00")
 ["2001-07-20 10:00:00+00","2001-07-20 10:03:00+00"]
 ["2001-01-19 06:11:00+00","2001-01-19 06:20:00+00")
 ("2001-07-19 21:33:00+00","2001-07-19 21:43:00+00"]
 ["2001-07-06 03:44:00+00","2001-07-06 03:47:00+00"]
 ("2001-02-14 17:57:00+00","2001-02-14 18:07:00+00")
 ["2001-05-23 14:32:00+00","2001-05-23 14:32:00+00"]
 ("2001-02-11 21:19:00+00","2001-02-11 21:27:00+00")
 ["2001-06-10 04:58:00+00","2001-06-10 05:08:00+00"]
 ("2001-09-04 18:32:00+00","2001-09-04 18:42:00+00"]
 ["2001-06-17 15:24:00+00","2001-06-17 15:28:00+00")
 ("2001-02-17 07:41:00+00","2001-02-17 07:45:00+00")
 ("2001-05-19 07:23:00+00","2001-05-19 07:31:00+00")
 ["2001-05-30 13:21:00+00","2001-05-30 13:29:00+00")
 ["2001-09-30 20:20:00+00","2001-09-30 20:27:00+00")
 ("2001-08-16 19:44:00+00","2001-08-16 19:50:00+00"]
 ("2001-12-17 06:38:00+00","2001-12-17 06:44:00+00")
 ["2001-08-10 04:18:00+00","2001-08-10 04:28:00+00"]
 ("2001-01-15 23:17:00+00","2001-01-15 23:22:00+00")
 ["2001-01-27 15:42:00+00","2001-01-27 15:46:00+00")
 ("2001-09-20 18:51:00+00","2001-09-20 18:52:00+00")
 ["2001-11-09 13:02:00+00","2001-11-09 13:02:00+00"]
 ["2001-01-26 23:05:00+00","2001-01-26 23:14:00+00"]
 ("2001-11-24 18:13:00+00","2001-11-24 18:18:00+00")
 ("2001-12-12 08:49:00+00","2001-12-12 08:52:00+00"]
 ["2001-05-19 20:46:00+00","2001-05-19 20:49:00+00"]
 ("2001-06-06 11:53:00+00","2001-06-06 11:59:00+00"]
 ["2001-02-23 01:06:00+00","2001-02-23 01:15:00+00")
 ["2001-12-14 17:09:00+00","2001-12-14 17:18:00+00"]
 ["2001-07-20 02:15:00+00","2001-07-20 02:16:00+00"]
 ("2001-04-02 19:35:00+00","2001-04-02 19:43:00+00")
 ["2001-05-23 01:11:00+00","2001-05-23 01:19:00+00")
 ["2001-03-31 21:56:00+00","2001-03-31 21:58:00+00"]
 ("2001-01-29 19:41:00+00","2001-01-29 19:51:00+00")
 ("2001-12-27 05:27:00+00","2001-12-27 05:34:00+00"]
 ("2001-03-09 14:27:00+00","2001-03-09 14:29:00+00"]
 ["2001-04-07 14:13:00+00","2001-04-07 14:21:00+00")
 ["2001-09-08 05:26:00+00","2001-09-08 05:35:00+00"]
 ("2001-04-27 19:32:00+00","2001-04-27 19:37:00+00"]
 ("2001-06-13 01:34:00+00","2001-06-13 01:44:00+00"]
 ["2001-03-14 16:28:00+00","2001-03-14 16:31:00+00")
 ["2001-07-29 07:45:00+00","2001-07-29 07:52:00+00"]
 ["2001-09-03 16:24:00+00","2001-09-03 16:24:00+00"]
 ["2001-11-02 19:10:00+00","2001-11-02 19:14:00+00"]
 ["2001-05-18 06:46:00+00","2001-05-18 06:51:00+00")
 ("2001-11-05 06:23:00+00","2001-11-05 06:33:00+00")
 ["2001-04-06 13:40:00+00","2001-04-06 13:48:00+00")
 ("2001-02-19 08:36:00+00","2001-02-19 08:44:00+00")
 ["2001-12-02 07:39:00+00","2001-12-02 07:46:00+00"]
 ("2001-08-13 23:10:00+00","2001-08-13 23:20:00+00")
 ("2001-08-07 08:09:00+00","2001-08-07 08:17:00+00"]
 ("2001-07-02 00:57:00+00","2001-07-02 01:05:00+00"]
 ["2001-03-14 01:42:00+00","2001-03-14 01:42:00+00"]
 ("2001-04-12 13:46:00+00","2001-04-12 13:55:00+00")
 ("2001-06-10 19:17:00+00","2001-06-10 19:19:00+00")
 ["2001-04-12 23:26:00+00","2001-04-12 23:30:00+00"]
 ("2001-02-20 02:22:00+00","2001-02-20 02:31:00+00")
 ("2001-12-30 16:01:00+00","2001-12-30 16:08:00+00"]
 ["2001-10-09 23:52:00+00","2001-10-09 23:52:00+00"]
 ("2001-06-12 17:06:00+00","2001-06-12 17:14:00+00"]
 ["2001-12-11 00:20:00+00","2001-12-11 00:23:00+00"]
 ("2001-01-29 03:19:00+00","2001-01-29 03:24:00+00")
 ["2001-02-14 12:51:00+00","2001-02-14 12:51:00+00"]
 ("2001-05-05 08:41:00+00","2001-05-05 08:51:00+00"]
 ["2001-03-21 12:43:00+00","2001-03-21 12:51:00+00")
 ["2001-08-28 15:18:00+00","2001-08-28 15:23:00+00"]
 ["2001-01-04 09:35:00+00","2001-01-04 09:44:00+00"]
 ["2001-10-10 22:01:00+00","2001-10-10 22:08:00+00")
 ["2001-10-06 17:26:00+00","2001-10-06 17:32:00+00")
 ("2001-12-15 03:18:00+00","2001-12-15 03:19:00+00")
 ("2001-12-06 18:46:00+00","2001-12-06 18:53:00+00"]
 ["2001-02-26 09:29:00+00","2001-02-26 09:31:00+00"]
 ("2001-02-03 05:19:00+00","2001-02-03 05:24:00+00")
 ("2001-10-29 15:54:00+00","2001-10-29 16:03:00+00")
 ("2001-10-04 16:18:00+00","2001-10-04 16:23:00+00"]
 ["2001-11-30 17:00:00+00","2001-11-30 17:08:00+00"]
 ("2001-01-01 03:28:00+00","2001-01-01 03:36:00+00")
 ("2001-10-03 09:21:00+00","2001-10-03 09:24:00+00")
 ["2001-05-17 23:21:00+00","2001-05-17 23:27:00+00")
 ("2001-05-15 00:40:00+00","2001-05-15 00:47:00+00")
 ["2001-03-31 08:01:00+00","2001-03-31 08:11:00+00"]
 ["2001-04-28 11:42:00+00","2001-04-28 11:47:00+00")
 ("2001-05-07 20:20:00+00","2001-05-07 20:27:00+00")
 ("2001-01-11 04:55:00+00","2001-01-11 05:02:00+00")
 ("2001-07-04 18:00:00+00","2001-07-04 18:01:00+00")
 ("2001-08-31 03:03:00+00","2001-08-31 03:06:00+00")
 ("2001-12-07 10:53:00+00","2001-12-07 11:02:00+00"]
 ("2001-05-03 21:14:00+00","2001-05-03 21:19:00+00"]
 ["2001-10-17 03:13:00+00","2001-10-17 03:21:00+00")
 ["2001-05-12 07:14:00+00","2001-05-12 07:18:00+00"]
 ["2001-07-01 18:09:00+00","2001-07-01 18:15:00+00"]
 ("2001-01-07 16:58:00+00","2001-01-07 17:02:00+00")
 ["2001-07-21 19:20:00+00","2001-07-21 19:21:00+00"]
 ("2001-06-24 08:39:00+00","2001-06-24 08:42:00+00"]
 ["2001-08-26 10:41:00+00","2001-08-26 10:49:00+00")
 ["2001-03-16 22:00:00+00","2001-03-16 22:04:00+00")
 ("2001-04-02 09:43:00+00","2001-04-02 09:46:00+00")
 ("2001-01-03 00:32:00+00","2001-01-03 00:38:00+00")
(100 rows)

select period(r) from tbl_tstzrange;
                      period                      
--------------------------------------------------
 (2001-07-23 13:20:00+00, 2001-07-23 13:23:00+00)
 [2001-05-04 02:11:00+00, 2001-05-04 02:11:00+00]
 (2001-09-05 19:22:00+00, 2001-09-05 19:32:00+00]
 [2001-07-04 21:05:00+00, 2001-07-04 21:14:00+00]
 [2001-03-18 15:36:00+00, 2001-03-18 15:41:00+00]
 (2001-05-11 03:27:00+00, 2001-05-11 03:28:00+00]
 [2001-06-30 10:21:00+00, 2001-06-30 10:21:00+00]
 [2001-03-07 06:09:00+00, 2001-03-07 06:11:00+00]
 (2001-01-01 19:30:00+00, 2001-01-01 19:36:00+00)
 (2001-03-06 18:33:00+00, 2001-03-06 18:40:00+00)
 [2001-10-28 14:54:00+00, 2001-10-28 14:54:00+00]
 (2001-03-27 01:01:00+00, 2001-03-27 01:07:00+00]
 [2001-03-26 14:33:00+00, 2001-03-26 14:33:00+00]
 (2001-11-24 03:12:00+00, 2001-11-24 03:15:00+00]
 (2001-10-01 01:19:00+00, 2001-10-01 01:22:00+00)
 (2001-02-04 01:57:00+00, 2001-02-04 01:58:00+00]
 (2001-05-09 10:22:00+00, 2001-05-09 10:29:00+00]
 (2001-05-31 20:26:00+00, 2001-05-31 20:31:00+00)
 (2001-02-13 00:02:00+00, 2001-02-13 00:12:00+00]
 (2001-03-23 15:23:00+00, 2001-03-23 15:25:00+00)
 [2001-05-15 08:07:00+00, 2001-05-15 08:15:00+00]
 (2001-02-03 06:17:00+00, 2001-02-03 06:26:00+00)
 (2001-06-05 01:51:00+00, 2001-06-05 01:54:00+00]
 (2001-02-05 15:19:00+00, 2001-02-05 15:25:00+00]
 (2001-12-13 06:40:00+00, 2001-12-13 06:44:00+00)
 [2001-02-21 02:07:00+00, 2001-02-21 02:15:00+00)
 (2001-02-02 01:56:00+00, 2001-02-02 02:01:00+00]
 [2001-09-30 20:01:00+00, 2001-09-30 20:01:00+00]
 [2001-04-26 09:05:00+00, 2001-04-26 09:05:00+00]
 [2001-05-13 19:19:00+00, 2001-05-13 19:26:00+00)
 [2001-03-17 04:10:00+00, 2001-03-17 04:19:00+00)
 [2001-04-25 19:19:00+00, 2001-04-25 19:20:00+00)
 (2001-11-05 15:48:00+00, 2001-11-05 15:51:00+00)
 (2001-06-26 23:14:00+00, 2001-06-26 23:24:00+00)
 [2001-04-17 07:47:00+00, 2001-04-17 07:56:00+00)
 (2001-10-31 21:12:00+00, 2001-10-31 21:20:00+00)
 (2001-09-11 17:45:00+00, 2001-09-11 17:54:00+00)
 [2001-11-10 10:59:00+00, 2001-11-10 11:07:00+00]
 (2001-10-22 09:51:00+00, 2001-10-22 09:58:00+00)
 [2001-06-01 12:33:00+00, 2001-06-01 12:40:00+00]
 [2001-08-03 14:17:00+00, 2001-08-03 14:17:00+00]
 (2001-03-08 19:48:00+00, 2001-03-08 19:50:00+00)
 [2001-01-20 10:46:00+00, 2001-01-20 10:55:00+00]
 (2001-01-30 03:34:00+00, 2001-01-30 03:42:00+00]
 (2001-12-26 01:09:00+00, 2001-12-26 01:14:00+00]
 [2001-10-16 01:44:00+00, 2001-10-16 01:47:00+00)
 [2001-01-14 05:40:00+00, 2001-01-14 05:40:00+00]
 [2001-02-01 12:34:00+00, 2001-02-01 12:43:00+00)
 [2001-12-09 08:27:00+00, 2001-12-09 08:34:00+00)
 (2001-01-04 19:51:00+00, 2001-01-04 19:59:00+00]
 [2001-04-03 16:48:00+00, 2001-04-03 16:48:00+00]
 (2001-08-29 01:46:00+00, 2001-08-29 01:49:00+00)
 (2001-10-14 03:00:00+00, 2001-10-14 03:04:00+00]
 (2001-07-06 12:54:00+00, 2001-07-06 12:55:00+00]
 (2001-01-18 08:15:00+00, 2001-01-18 08:16:00+00]
 (2001-10-09 07:10:00+00, 2001-10-09 07:19:00+00)
 [2001-10-25 07:09:00+00, 2001-10-25 07:10:00+00]
 (2001-09-07 10:39:00+00, 2001-09-07 10:45:00+00]
 (2001-04-22 00:52:00+00, 2001-04-22 00:54:00+00)
 (2001-09-05 04:19:00+00, 2001-09-05 04:24:00+00)
 [2001-03-12 04:13:00+00, 2001-03-12 04:14:00+00)
 [2001-08-27 08:49:00+00, 2001-08-27 08:55:00+00]
 (2001-08-20 23:01:00+00, 2001-08-20 23:03:00+00)
 (2001-05-19 22:11:00+00, 2001-05-19 22:18:00+00)
 (2001-11-22 19:08:00+00, 2001-11-22 19:09:00+00)
 [2001-05-14 04:19:00+00, 2001-05-14 04:29:00+00]
 (2001-06-09 06:53:00+00, 2001-06-09 06:55:00+00)
 (2001-01-28 20:08:00+00, 2001-01-28 20:14:00+00]
 (2001-11-11 13:55:00+00, 2001-11-11 14:04:00+00)
 [2001-05-11 00:32:00+00, 2001-05-11 00:42:00+00]
 [2001-06-10 11:07:00+00, 2001-06-10 11:16:00+00]
 [2001-10-05 10:25:00+00, 2001-10-05 10:31:00+00]
 (2001-09-30 12:03:00+00, 2001-09-30 12:06:00+00]
 [2001-04-26 12:59:00+00, 2001-04-26 13:07:00+00]
 (2001-05-24 19:11:00+00, 2001-05-24 19:18:00+00]
 (2001-02-14 12:22:00+00, 2001-02-14 12:29:00+00]
 (2001-04-07 00:51:00+00, 2001-04-07 01:01:00+00]
 [2001-02-21 22:59:00+00, 2001-02-21 23:04:00+00]
 [2001-06-15 19:58:00+00, 2001-06-15 20:03:00+00]
 (2001-11-14 13:56:00+00, 2001-11-14 14:02:00+00]
 (2001-03-05 15:13:00+00, 2001-03-05 15:21:00+00)
 [2001-10-07 00:09:00+00, 2001-10-07 00:14:00+00)
 [2001-04-18 15:22:00+00, 2001-04-18 15:25:00+00]
 [2001-10-11 07:42:00+00, 2001-10-11 07:49:00+00]
 (2001-05-30 19:29:00+00, 2001-05-30 19:38:00+00)
 [2001-10-19 22:55:00+00, 2001-10-19 23:02:00+00)
 [2001-06-02 09:41:00+00, 2001-06-02 09:50:00+00)
 (2001-07-26 17:18:00+00, 2001-07-26 17:22:00+00)
 [2001-12-21 16:36:00+00, 2001-12-21 16:37:00+00]
 [2001-11-16 14:38:00+00, 2001-11-16 14:42:00+00]
 (2001-06-10 14:28:00+00, 2001-06-10 14:32:00+00]
 (2001-05-04 11:12:00+00, 2001-05-04 11:20:00+00)
 (2001-12-14 15:35:00+00, 2001-12-14 15:36:00+00]
 (2001-12-18 06:15:00+00, 2001-12-18 06:21:00+00)
 (2001-08-25 08:39:00+00, 2001-08-25 08:42:00+00)
 [2001-03-04 03:08:00+00, 2001-03-04 03:18:00+00]
 (2001-02-05 05:07:00+00, 2001-02-05 05:09:00+00]
 [2001-07-15 11:11:00+00, 2001-07-15 11:12:00+00]
 [2001-06-19 14:17:00+00, 2001-06-19 14:23:00+00]
 [2001-10-01 23:31:00+00, 2001-10-01 23:41:00+00)
(100 rows)

select lower(p) from tbl_period;
         lower          
------------------------
 2001-01-08 03:08:00+00
 2001-05-21 15:01:00+00
 2001-12-28 07:19:00+00
 2001-07-20 10:00:00+00
 2001-01-19 06:11:00+00
 2001-07-19 21:33:00+00
 2001-07-06 03:44:00+00
 2001-02-14 17:57:00+00
 2001-05-23 14:32:00+00
 2001-02-11 21:19:00+00
 2001-06-10 04:58:00+00
 2001-09-04 18:32:00+00
 2001-06-17 15:24:00+00
 2001-02-17 07:41:00+00
 2001-05-19 07:23:00+00
 2001-05-30 13:21:00+00
 2001-09-30 20:20:00+00
 2001-08-16 19:44:00+00
 2001-12-17 06:38:00+00
 2001-08-10 04:18:00+00
 2001-01-15 23:17:00+00
 2001-01-27 15:42:00+00
 2001-09-20 18:51:00+00
 2001-11-09 13:02:00+00
 2001-01-26 23:05:00+00
 2001-11-24 18:13:00+00
 2001-12-12 08:49:00+00
 2001-05-19 20:46:00+00
 2001-06-06 11:53:00+00
 2001-02-23 01:06:00+00
 2001-12-14 17:09:00+00
 2001-07-20 02:15:00+00
 2001-04-02 19:35:00+00
 2001-05-23 01:11:00+00
 2001-03-31 21:56:00+00
 2001-01-29 19:41:00+00
 2001-12-27 05:27:00+00
 2001-03-09 14:27:00+00
 2001-04-07 14:13:00+00
 2001-09-08 05:26:00+00
 2001-04-27 19:32:00+00
 2001-06-13 01:34:00+00
 2001-03-14 16:28:00+00
 2001-07-29 07:45:00+00
 2001-09-03 16:24:00+00
 2001-11-02 19:10:00+00
 2001-05-18 06:46:00+00
 2001-11-05 06:23:00+00
 2001-04-06 13:40:00+00
 2001-02-19 08:36:00+00
 2001-12-02 07:39:00+00
 2001-08-13 23:10:00+00
 2001-08-07 08:09:00+00
 2001-07-02 00:57:00+00
 2001-03-14 01:42:00+00
 2001-04-12 13:46:00+00
 2001-06-10 19:17:00+00
 2001-04-12 23:26:00+00
 2001-02-20 02:22:00+00
 2001-12-30 16:01:00+00
 2001-10-09 23:52:00+00
 2001-06-12 17:06:00+00
 2001-12-11 00:20:00+00
 2001-01-29 03:19:00+00
 2001-02-14 12:51:00+00
 2001-05-05 08:41:00+00
 2001-03-21 12:43:00+00
 2001-08-28 15:18:00+00
 2001-01-04 09:35:00+00
 2001-10-10 22:01:00+00
 2001-10-06 17:26:00+00
 2001-12-15 03:18:00+00
 2001-12-06 18:46:00+00
 2001-02-26 09:29:00+00
 2001-02-03 05:19:00+00
 2001-10-29 15:54:00+00
 2001-10-04 16:18:00+00
 2001-11-30 17:00:00+00
 2001-01-01 03:28:00+00
 2001-10-03 09:21:00+00
 2001-05-17 23:21:00+00
 2001-05-15 00:40:00+00
 2001-03-31 08:01:00+00
 2001-04-28 11:42:00+00
 2001-05-07 20:20:00+00
 2001-01-11 04:55:00+00
 2001-07-04 18:00:00+00
 2001-08-31 03:03:00+00
 2001-12-07 10:53:00+00
 2001-05-03 21:14:00+00
 2001-10-17 03:13:00+00
 2001-05-12 07:14:00+00
 2001-07-01 18:09:00+00
 2001-01-07 16:58:00+00
 2001-07-21 19:20:00+00
 2001-06-24 08:39:00+00
 2001-08-26 10:41:00+00
 2001-03-16 22:00:00+00
 2001-04-02 09:43:00+00
 2001-01-03 00:32:00+00
(100 rows)

select upper(p) from tbl_period;
         upper          
------------------------
 2001-01-08 03:11:00+00
 2001-05-21 15:05:00+00
 2001-12-28 07:22:00+00
 2001-07-20 10:03:00+00
 2001-01-19 06:20:00+00
 2001-07-19 21:43:00+00
 2001-07-06 03:47:00+00
 2001-02-14 18:07:00+00
 2001-05-23 14:32:00+00
 2001-02-11 21:27:00+00
 2001-06-10 05:08:00+00
 2001-09-04 18:42:00+00
 2001-06-17 15:28:00+00
 2001-02-17 07:45:00+00
 2001-05-19 07:31:00+00
 2001-05-30 13:29:00+00
 2001-09-30 20:27:00+00
 2001-08-16 19:50:00+00
 2001-12-17 06:44:00+00
 2001-08-10 04:28:00+00
 2001-01-15 23:22:00+00
 2001-01-27 15:46:00+00
 2001-09-20 18:52:00+00
 2001-11-09 13:02:00+00
 2001-01-26 23:14:00+00
 2001-11-24 18:18:00+00
 2001-12-12 08:52:00+00
 2001-05-19 20:49:00+00
 2001-06-06 11:59:00+00
 2001-02-23 01:15:00+00
 2001-12-14 17:18:00+00
 2001-07-20 02:16:00+00
 2001-04-02 19:43:00+00
 2001-05-23 01:19:00+00
 2001-03-31 21:58:00+00
 2001-01-29 19:51:00+00
 2001-12-27 05:34:00+00
 2001-03-09 14:29:00+00
 2001-04-07 14:21:00+00
 2001-09-08 05:35:00+00
 2001-04-27 19:37:00+00
 2001-06-13 01:44:00+00
 2001-03-14 16:31:00+00
 2001-07-29 07:52:00+00
 2001-09-03 16:24:00+00
 2001-11-02 19:14:00+00
 2001-05-18 06:51:00+00
 2001-11-05 06:33:00+00
 2001-04-06 13:48:00+00
 2001-02-19 08:44:00+00
 2001-12-02 07:46:00+00
 2001-08-13 23:20:00+00
 2001-08-07 08:17:00+00
 2001-07-02 01:05:00+00
 2001-03-14 01:42:00+00
 2001-04-12 13:55:00+00
 2001-06-10 19:19:00+00
 2001-04-12 23:30:00+00
 2001-02-20 02:31:00+00
 2001-12-30 16:08:00+00
 2001-10-09 23:52:00+00
 2001-06-12 17:14:00+00
 2001-12-11 00:23:00+00
 2001-01-29 03:24:00+00
 2001-02-14 12:51:00+00
 2001-05-05 08:51:00+00
 2001-03-21 12:51:00+00
 2001-08-28 15:23:00+00
 2001-01-04 09:44:00+00
 2001-10-10 22:08:00+00
 2001-10-06 17:32:00+00
 2001-12-15 03:19:00+00
 2001-12-06 18:53:00+00
 2001-02-26 09:31:00+00
 2001-02-03 05:24:00+00
 2001-10-29 16:03:00+00
 2001-10-04 16:23:00+00
 2001-11-30 17:08:00+00
 2001-01-01 03:36:00+00
 2001-10-03 09:24:00+00
 2001-05-17 23:27:00+00
 2001-05-15 00:47:00+00
 2001-03-31 08:11:00+00
 2001-04-28 11:47:00+00
 2001-05-07 20:27:00+00
 2001-01-11 05:02:00+00
 2001-07-04 18:01:00+00
 2001-08-31 03:06:00+00
 2001-12-07 11:02:00+00
 2001-05-03 21:19:00+00
 2001-10-17 03:21:00+00
 2001-05-12 07:18:00+00
 2001-07-01 18:15:00+00
 2001-01-07 17:02:00+00
 2001-07-21 19:21:00+00
 2001-06-24 08:42:00+00
 2001-08-26 10:49:00+00
 2001-03-16 22:04:00+00
 2001-04-02 09:46:00+00
 2001-01-03 00:38:00+00
(100 rows)

select lower_inc(p) from tbl_period;
 lower_inc 
-----------
 f
 t
 t
 t
 t
 f
 t
 f
 t
 f
 t
 f
 t
 f
 f
 t
 t
 f
 f
 t
 f
 t
 f
 t
 t
 f
 f
 t
 f
 t
 t
 t
 f
 t
 t
 f
 f
 f
 t
 t
 f
 f
 t
 t
 t
 t
 t
 f
 t
 f
 t
 f
 f
 f
 t
 f
 f
 t
 f
 f
 t
 f
 t
 f
 t
 f
 t
 t
 t
 t
 t
 f
 f
 t
 f
 f
 f
 t
 f
 f
 t
 f
 t
 t
 f
 f
 f
 f
 f
 f
 t
 t
 t
 f
 t
 f
 t
 t
 f
 f
(100 rows)

select upper_inc(p) from tbl_period;
 upper_inc 
-----------
 t
 t
 f
 t
 f
 t
 t
 f
 t
 f
 t
 t
 f
 f
 f
 f
 f
 t
 f
 t
 f
 f
 f
 t
 t
 f
 t
 t
 t
 f
 t
 t
 f
 f
 t
 f
 t
 t
 f
 t
 t
 t
 f
 t
 t
 t
 f
 f
 f
 f
 t
 f
 t
 t
 t
 f
 f
 t
 f
 t
 t
 t
 t
 f
 t
 t
 f
 t
 t
 f
 f
 f
 t
 t
 f
 f
 t
 t
 f
 f
 f
 f
 t
 f
 f
 f
 f
 f
 t
 t
 f
 t
 t
 f
 t
 t
 f
 f
 f
 f
(100 rows)

select duration(p) from tbl_period;
 duration 
----------
 00:03:00
 00:04:00
 00:03:00
 00:03:00
 00:09:00
 00:10:00
 00:03:00
 00:10:00
 00:00:00
 00:08:00
 00:10:00
 00:10:00
 00:04:00
 00:04:00
 00:08:00
 00:08:00
 00:07:00
 00:06:00
 00:06:00
 00:10:00
 00:05:00
 00:04:00
 00:01:00
 00:00:00
 00:09:00
 00:05:00
 00:03:00
 00:03:00
 00:06:00
 00:09:00
 00:09:00
 00:01:00
 00:08:00
 00:08:00
 00:02:00
 00:10:00
 00:07:00
 00:02:00
 00:08:00
 00:09:00
 00:05:00
 00:10:00
 00:03:00
 00:07:00
 00:00:00
 00:04:00
 00:05:00
 00:10:00
 00:08:00
 00:08:00
 00:07:00
 00:10:00
 00:08:00
 00:08:00
 00:00:00
 00:09:00
 00:02:00
 00:04:00
 00:09:00
 00:07:00
 00:00:00
 00:08:00
 00:03:00
 00:05:00
 00:00:00
 00:10:00
 00:08:00
 00:05:00
 00:09:00
 00:07:00
 00:06:00
 00:01:00
 00:07:00
 00:02:00
 00:05:00
 00:09:00
 00:05:00
 00:08:00
 00:08:00
 00:03:00
 00:06:00
 00:07:00
 00:10:00
 00:05:00
 00:07:00
 00:07:00
 00:01:00
 00:03:00
 00:09:00
 00:05:00
 00:08:00
 00:04:00
 00:06:00
 00:04:00
 00:01:00
 00:03:00
 00:08:00
 00:04:00
 00:03:00
 00:06:00
(100 rows)

select shift(p, '5 min') from tbl_period;
                      shift                       
--------------------------------------------------
 (2001-01-08 03:13:00+00, 2001-01-08 03:16:00+00]
 [2001-05-21 15:06:00+00, 2001-05-21 15:10:00+00]
 [2001-12-28 07:24:00+00, 2001-12-28 07:27:00+00)
 [2001-07-20 10:05:00+00, 2001-07-20 10:08:00+00]
 [2001-01-19 06:16:00+00, 2001-01-19 06:25:00+00)
 (2001-07-19 21:38:00+00, 2001-07-19 21:48:00+00]
 [2001-07-06 03:49:00+00, 2001-07-06 03:52:00+00]
 (2001-02-14 18:02:00+00, 2001-02-14 18:12:00+00)
 [2001-05-23 14:37:00+00, 2001-05-23 14:37:00+00]
 (2001-02-11 21:24:00+00, 2001-02-11 21:32:00+00)
 [2001-06-10 05:03:00+00, 2001-06-10 05:13:00+00]
 (2001-09-04 18:37:00+00, 2001-09-04 18:47:00+00]
 [2001-06-17 15:29:00+00, 2001-06-17 15:33:00+00)
 (2001-02-17 07:46:00+00, 2001-02-17 07:50:00+00)
 (2001-05-19 07:28:00+00, 2001-05-19 07:36:00+00)
 [2001-05-30 13:26:00+00, 2001-05-30 13:34:00+00)
 [2001-09-30 20:25:00+00, 2001-09-30 20:32:00+00)
 (2001-08-16 19:49:00+00, 2001-08-16 19:55:00+00]
 (2001-12-17 06:43:00+00, 2001-12-17 06:49:00+00)
 [2001-08-10 04:23:00+00, 2001-08-10 04:33:00+00]
 (2001-01-15 23:22:00+00, 2001-01-15 23:27:00+00)
 [2001-01-27 15:47:00+00, 2001-01-27 15:51:00+00)
 (2001-09-20 18:56:00+00, 2001-09-20 18:57:00+00)
 [2001-11-09 13:07:00+00, 2001-11-09 13:07:00+00]
 [2001-01-26 23:10:00+00, 2001-01-26 23:19:00+00]
 (2001-11-24 18:18:00+00, 2001-11-24 18:23:00+00)
 (2001-12-12 08:54:00+00, 2001-12-12 08:57:00+00]
 [2001-05-19 20:51:00+00, 2001-05-19 20:54:00+00]
 (2001-06-06 11:58:00+00, 2001-06-06 12:04:00+00]
 [2001-02-23 01:11:00+00, 2001-02-23 01:20:00+00)
 [2001-12-14 17:14:00+00, 2001-12-14 17:23:00+00]
 [2001-07-20 02:20:00+00, 2001-07-20 02:21:00+00]
 (2001-04-02 19:40:00+00, 2001-04-02 19:48:00+00)
 [2001-05-23 01:16:00+00, 2001-05-23 01:24:00+00)
 [2001-03-31 22:01:00+00, 2001-03-31 22:03:00+00]
 (2001-01-29 19:46:00+00, 2001-01-29 19:56:00+00)
 (2001-12-27 05:32:00+00, 2001-12-27 05:39:00+00]
 (2001-03-09 14:32:00+00, 2001-03-09 14:34:00+00]
 [2001-04-07 14:18:00+00, 2001-04-07 14:26:00+00)
 [2001-09-08 05:31:00+00, 2001-09-08 05:40:00+00]
 (2001-04-27 19:37:00+00, 2001-04-27 19:42:00+00]
 (2001-06-13 01:39:00+00, 2001-06-13 01:49:00+00]
 [2001-03-14 16:33:00+00, 2001-03-14 16:36:00+00)
 [2001-07-29 07:50:00+00, 2001-07-29 07:57:00+00]
 [2001-09-03 16:29:00+00, 2001-09-03 16:29:00+00]
 [2001-11-02 19:15:00+00, 2001-11-02 19:19:00+00]
 [2001-05-18 06:51:00+00, 2001-05-18 06:56:00+00)
 (2001-11-05 06:28:00+00, 2001-11-05 06:38:00+00)
 [2001-04-06 13:45:00+00, 2001-04-06 13:53:00+00)
 (2001-02-19 08:41:00+00, 2001-02-19 08:49:00+00)
 [2001-12-02 07:44:00+00, 2001-12-02 07:51:00+00]
 (2001-08-13 23:15:00+00, 2001-08-13 23:25:00+00)
 (2001-08-07 08:14:00+00, 2001-08-07 08:22:00+00]
 (2001-07-02 01:02:00+00, 2001-07-02 01:10:00+00]
 [2001-03-14 01:47:00+00, 2001-03-14 01:47:00+00]
 (2001-04-12 13:51:00+00, 2001-04-12 14:00:00+00)
 (2001-06-10 19:22:00+00, 2001-06-10 19:24:00+00)
 [2001-04-12 23:31:00+00, 2001-04-12 23:35:00+00]
 (2001-02-20 02:27:00+00, 2001-02-20 02:36:00+00)
 (2001-12-30 16:06:00+00, 2001-12-30 16:13:00+00]
 [2001-10-09 23:57:00+00, 2001-10-09 23:57:00+00]
 (2001-06-12 17:11:00+00, 2001-06-12 17:19:00+00]
 [2001-12-11 00:25:00+00, 2001-12-11 00:28:00+00]
 (2001-01-29 03:24:00+00, 2001-01-29 03:29:00+00)
 [2001-02-14 12:56:00+00, 2001-02-14 12:56:00+00]
 (2001-05-05 08:46:00+00, 2001-05-05 08:56:00+00]
 [2001-03-21 12:48:00+00, 2001-03-21 12:56:00+00)
 [2001-08-28 15:23:00+00, 2001-08-28 15:28:00+00]
 [2001-01-04 09:40:00+00, 2001-01-04 09:49:00+00]
 [2001-10-10 22:06:00+00, 2001-10-10 22:13:00+00)
 [2001-10-06 17:31:00+00, 2001-10-06 17:37:00+00)
 (2001-12-15 03:23:00+00, 2001-12-15 03:24:00+00)
 (2001-12-06 18:51:00+00, 2001-12-06 18:58:00+00]
 [2001-02-26 09:34:00+00, 2001-02-26 09:36:00+00]
 (2001-02-03 05:24:00+00, 2001-02-03 05:29:00+00)
 (2001-10-29 15:59:00+00, 2001-10-29 16:08:00+00)
 (2001-10-04 16:23:00+00, 2001-10-04 16:28:00+00]
 [2001-11-30 17:05:00+00, 2001-11-30 17:13:00+00]
 (2001-01-01 03:33:00+00, 2001-01-01 03:41:00+00)
 (2001-10-03 09:26:00+00, 2001-10-03 09:29:00+00)
 [2001-05-17 23:26:00+00, 2001-05-17 23:32:00+00)
 (2001-05-15 00:45:00+00, 2001-05-15 00:52:00+00)
 [2001-03-31 08:06:00+00, 2001-03-31 08:16:00+00]
 [2001-04-28 11:47:00+00, 2001-04-28 11:52:00+00)
 (2001-05-07 20:25:00+00, 2001-05-07 20:32:00+00)
 (2001-01-11 05:00:00+00, 2001-01-11 05:07:00+00)
 (2001-07-04 18:05:00+00, 2001-07-04 18:06:00+00)
 (2001-08-31 03:08:00+00, 2001-08-31 03:11:00+00)
 (2001-12-07 10:58:00+00, 2001-12-07 11:07:00+00]
 (2001-05-03 21:19:00+00, 2001-05-03 21:24:00+00]
 [2001-10-17 03:18:00+00, 2001-10-17 03:26:00+00)
 [2001-05-12 07:19:00+00, 2001-05-12 07:23:00+00]
 [2001-07-01 18:14:00+00, 2001-07-01 18:20:00+00]
 (2001-01-07 17:03:00+00, 2001-01-07 17:07:00+00)
 [2001-07-21 19:25:00+00, 2001-07-21 19:26:00+00]
 (2001-06-24 08:44:00+00, 2001-06-24 08:47:00+00]
 [2001-08-26 10:46:00+00, 2001-08-26 10:54:00+00)
 [2001-03-16 22:05:00+00, 2001-03-16 22:09:00+00)
 (2001-04-02 09:48:00+00, 2001-04-02 09:51:00+00)
 (2001-01-03 00:37:00+00, 2001-01-03 00:43:00+00)
(100 rows)

select count(*) from tbl_period t1, tbl_period t2 where period_cmp(t1.p, t2.p) = -1;
 count 
-------
  4950
(1 row)

select count(*) from tbl_period t1, tbl_period t2 where t1.p < t2.p;
 count 
-------
  4950
(1 row)

select count(*) from tbl_period t1, tbl_period t2 where t1.p <= t2.p;
 count 
-------
  5050
(1 row)

select count(*) from tbl_period t1, tbl_period t2 where t1.p > t2.p;
 count 
-------
  4950
(1 row)

select count(*) from tbl_period t1, tbl_period t2 where t1.p >= t2.p;
 count 
-------
  5050
(1 row)

