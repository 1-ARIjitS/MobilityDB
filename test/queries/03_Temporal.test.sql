-------------------------------------------------------------------------------
-- Input/output functions
-------------------------------------------------------------------------------

-- Temporal instant

select tbool 'TRUE@2012-01-01 08:00:00';
select tbool 'FALSE@2012-01-01 08:00:00';

select tint '1@2012-01-01 08:00:00';
select tint '2@2012-01-01 08:00:00';

select tfloat '1@2012-01-01 08:00:00';
select tfloat '2@2012-01-01 08:00:00';

select ttext 'AAA@2012-01-01 08:00:00';
select ttext 'BBB@2012-01-01 08:00:00';

/* Error
select tbool '2@2012-01-01 08:00:00';
select tint 'TRUE@2012-01-01 08:00:00';
select tfloat 'ABC@2012-01-01 08:00:00';
*/

-------------------------------------------------------------------------------

-- Temporal instant set

select tbool ' { true@2001-01-01 08:00:00 , false@2001-01-01 08:05:00 , true@2001-01-01 08:06:00 } ';
select tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}';

select tint ' { 1@2001-01-01 08:00:00 , 2@2001-01-01 08:05:00 , 3@2001-01-01 08:06:00 } ';
select tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}';

select tfloat ' { 1@2001-01-01 08:00:00 , 2@2001-01-01 08:05:00 , 3@2001-01-01 08:06:00 } ';
select tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}';

select ttext ' { A@2001-01-01 08:00:00 , B@2001-01-01 08:05:00 , C@2001-01-01 08:06:00 } ';
select ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}';

-------------------------------------------------------------------------------

-- Temporal sequence

select tbool ' [ true@2001-01-01 08:00:00 , false@2001-01-01 08:05:00 , true@2001-01-01 08:06:00 ] ';
select tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]';

select tint ' [ 1@2001-01-01 08:00:00 , 2@2001-01-01 08:05:00 , 3@2001-01-01 08:06:00 ] ';
select tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]';

select tfloat ' [ 1@2001-01-01 08:00:00 , 2@2001-01-01 08:05:00 , 3@2001-01-01 08:06:00 ] ';
select tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]';

select ttext ' [ A@2001-01-01 08:00:00 , B@2001-01-01 08:05:00 , C@2001-01-01 08:06:00 ] ';
select ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]';

/* Error
select tbool ' [ true@2001-01-01 08:00:00 , false@2001-01-01 08:05:00 , true@2001-01-01 08:06:00 ) ';
*/

-------------------------------------------------------------------------------

-- Temporal sequence set

select tbool '  { [ true@2001-01-01 08:00:00 , false@2001-01-01 08:05:00 , true@2001-01-01 08:06:00 ],
 [ true@2001-01-01 09:00:00 , false@2001-01-01 09:05:00 , true@2001-01-01 09:06:00 ] } ';
select tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}';

select tint '  { [ 1@2001-01-01 08:00:00 , 2@2001-01-01 08:05:00 , 3@2001-01-01 08:06:00 ],
 [ 1@2001-01-01 09:00:00 , 2@2001-01-01 09:05:00 , 1@2001-01-01 09:06:00 ] } ';
select tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}';

select tfloat '  { [ 1@2001-01-01 08:00:00 , 2@2001-01-01 08:05:00 , 3@2001-01-01 08:06:00 ],
 [ 1@2001-01-01 09:00:00 , 2@2001-01-01 09:05:00 , 1@2001-01-01 09:06:00 ] } ';
select tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}';

select ttext '  { [ AAA@2001-01-01 08:00:00 , BBB@2001-01-01 08:05:00 , CCC@2001-01-01 08:06:00 ],
 [ AAA@2001-01-01 09:00:00 , BBB@2001-01-01 09:05:00 , CCC@2001-01-01 09:06:00 ] } ';
select ttext '{[AAA@2001-01-01 08:00:00,BBB@2001-01-01 08:05:00,CCC@2001-01-01 08:06:00],
 [AAA@2001-01-01 09:00:00,BBB@2001-01-01 09:05:00,CCC@2001-01-01 09:06:00]}';

-------------------------------------------------------------------------------
-- typmod
-------------------------------------------------------------------------------

select tbool 'true@2000-01-01';
select tbool '{true@2000-01-01, false@2000-01-02}';
select tbool '[true@2000-01-01, false@2000-01-02]';
select tbool '{[true@2000-01-01, false@2000-01-02], [true@2000-01-03, false@2000-01-04]}';

select tbool(Instant) 'true@2000-01-01';
select tbool(InstantSet) '{true@2000-01-01, false@2000-01-02}';
select tbool(Sequence) '[true@2000-01-01, false@2000-01-02]';
select tbool(SequenceSet) '{[true@2000-01-01, false@2000-01-02], [true@2000-01-03, false@2000-01-04]}';

/* Error
select tbool(InstantSet) 'true@2000-01-01';
select tbool(Sequence) 'true@2000-01-01';
select tbool(SequenceSet) 'true@2000-01-01';

select tbool(Instant) '{true@2000-01-01, false@2000-01-02}';
select tbool(Sequence) '{true@2000-01-01, false@2000-01-02}';
select tbool(SequenceSet) '{true@2000-01-01, false@2000-01-02}';

select tbool(Instant) '[true@2000-01-01, false@2000-01-02]';
select tbool(InstantSet) '[true@2000-01-01, false@2000-01-02]';
select tbool(SequenceSet) '[true@2000-01-01, false@2000-01-02]';

select tbool(Instant) '{[true@2000-01-01, false@2000-01-02], [true@2000-01-03, false@2000-01-04]}';
select tbool(InstantSet) '{[true@2000-01-01, false@2000-01-02], [true@2000-01-03, false@2000-01-04]}';
select tbool(Sequence) '{[true@2000-01-01, false@2000-01-02], [true@2000-01-03, false@2000-01-04]}';
*/

select tint '1@2000-01-01';
select tint '{1@2000-01-01, 2@2000-01-02}';
select tint '[1@2000-01-01, 2@2000-01-02]';
select tint '{[1@2000-01-01, 2@2000-01-02], [1@2000-01-03, 2@2000-01-04]}';

select tint(Instant) '1@2000-01-01';
select tint(InstantSet) '{1@2000-01-01, 2@2000-01-02}';
select tint(Sequence) '[1@2000-01-01, 2@2000-01-02]';
select tint(SequenceSet) '{[1@2000-01-01, 2@2000-01-02], [1@2000-01-03, 2@2000-01-04]}';

/* Error
select tint(InstantSet) '1@2000-01-01';
select tint(Sequence) '1@2000-01-01';
select tint(SequenceSet) '1@2000-01-01';

select tint(Instant) '{1@2000-01-01, 2@2000-01-02}';
select tint(Sequence) '{1@2000-01-01, 2@2000-01-02}';
select tint(SequenceSet) '{1@2000-01-01, 2@2000-01-02}';

select tint(Instant) '[1@2000-01-01, 2@2000-01-02]';
select tint(InstantSet) '[1@2000-01-01, 2@2000-01-02]';
select tint(SequenceSet) '[1@2000-01-01, 2@2000-01-02]';

select tint(Instant) '{[1@2000-01-01, 2@2000-01-02], [1@2000-01-03, 2@2000-01-04]}';
select tint(InstantSet) '{[1@2000-01-01, 2@2000-01-02], [1@2000-01-03, 2@2000-01-04]}';
select tint(Sequence) '{[1@2000-01-01, 2@2000-01-02], [1@2000-01-03, 2@2000-01-04]}';
*/

select tfloat '1@2000-01-01';
select tfloat '{1@2000-01-01, 2@2000-01-02}';
select tfloat '[1@2000-01-01, 2@2000-01-02]';
select tfloat '{[1@2000-01-01, 2@2000-01-02], [1@2000-01-03, 2@2000-01-04]}';

select tfloat(Instant) '1@2000-01-01';
select tfloat(InstantSet) '{1@2000-01-01, 2@2000-01-02}';
select tfloat(Sequence) '[1@2000-01-01, 2@2000-01-02]';
select tfloat(SequenceSet) '{[1@2000-01-01, 2@2000-01-02], [1@2000-01-03, 2@2000-01-04]}';

/* Error
select tfloat(InstantSet) '1@2000-01-01';
select tfloat(Sequence) '1@2000-01-01';
select tfloat(SequenceSet) '1@2000-01-01';

select tfloat(Instant) '{1@2000-01-01, 2@2000-01-02}';
select tfloat(Sequence) '{1@2000-01-01, 2@2000-01-02}';
select tfloat(SequenceSet) '{1@2000-01-01, 2@2000-01-02}';

select tfloat(Instant) '[1@2000-01-01, 2@2000-01-02]';
select tfloat(InstantSet) '[1@2000-01-01, 2@2000-01-02]';
select tfloat(SequenceSet) '[1@2000-01-01, 2@2000-01-02]';

select tfloat(Instant) '{[1@2000-01-01, 2@2000-01-02], [1@2000-01-03, 2@2000-01-04]}';
select tfloat(InstantSet) '{[1@2000-01-01, 2@2000-01-02], [1@2000-01-03, 2@2000-01-04]}';
select tfloat(Sequence) '{[1@2000-01-01, 2@2000-01-02], [1@2000-01-03, 2@2000-01-04]}';
*/

select ttext '1@2000-01-01';
select ttext '{1@2000-01-01, 2@2000-01-02}';
select ttext '[1@2000-01-01, 2@2000-01-02]';
select ttext '{[1@2000-01-01, 2@2000-01-02], [1@2000-01-03, 2@2000-01-04]}';

select ttext(Instant) '1@2000-01-01';
select ttext(InstantSet) '{1@2000-01-01, 2@2000-01-02}';
select ttext(Sequence) '[1@2000-01-01, 2@2000-01-02]';
select ttext(SequenceSet) '{[1@2000-01-01, 2@2000-01-02], [1@2000-01-03, 2@2000-01-04]}';

/* Error
select ttext(InstantSet) '1@2000-01-01';
select ttext(Sequence) '1@2000-01-01';
select ttext(SequenceSet) '1@2000-01-01';

select ttext(Instant) '{1@2000-01-01, 2@2000-01-02}';
select ttext(Sequence) '{1@2000-01-01, 2@2000-01-02}';
select ttext(SequenceSet) '{1@2000-01-01, 2@2000-01-02}';

select ttext(Instant) '[1@2000-01-01, 2@2000-01-02]';
select ttext(InstantSet) '[1@2000-01-01, 2@2000-01-02]';
select ttext(SequenceSet) '[1@2000-01-01, 2@2000-01-02]';

select ttext(Instant) '{[1@2000-01-01, 2@2000-01-02], [1@2000-01-03, 2@2000-01-04]}';
select ttext(InstantSet) '{[1@2000-01-01, 2@2000-01-02], [1@2000-01-03, 2@2000-01-04]}';
select ttext(Sequence) '{[1@2000-01-01, 2@2000-01-02], [1@2000-01-03, 2@2000-01-04]}';
*/
-------------------------------------------------------------------------------
-- Constructor functions
-------------------------------------------------------------------------------

select tboolinst(TRUE, '2012-01-01 08:00:00');
select tboolinst(NULL, '2012-01-01 08:00:00');

select tintinst(1, '2012-01-01 08:00:00');
select tintinst(NULL, '2012-01-01 08:00:00');

select tfloatinst(1, '2012-01-01 08:00:00');
select tfloatinst(NULL, '2012-01-01 08:00:00');

select ttextinst('AAA', '2001-01-01 08:00:00');

-------------------------------------------------------------------------------

select tbooli(ARRAY[
tboolinst(true, '2012-01-01 08:00:00'),
tboolinst(true, '2012-01-01 08:10:00'),
tboolinst(true, '2012-01-01 08:20:00')
]);

select tinti(ARRAY[
tintinst(1, '2012-01-01 08:00:00'),
tintinst(2, '2012-01-01 08:10:00'),
tintinst(3, '2012-01-01 08:20:00')
]);

select tfloati(ARRAY[
tfloatinst(1, '2012-01-01 08:00:00'),
tfloatinst(2, '2012-01-01 08:10:00'),
tfloatinst(3, '2012-01-01 08:20:00')
]);

select ttexti(ARRAY[
ttextinst('A', '2012-01-01 08:00:00'),
ttextinst('B', '2012-01-01 08:10:00'),
ttextinst('C', '2012-01-01 08:20:00')
]);

-------------------------------------------------------------------------------

select tboolseq(ARRAY[
tboolinst(true, '2012-01-01 08:00:00'),
tboolinst(true, '2012-01-01 08:10:00'),
tboolinst(true, '2012-01-01 08:20:00')
]);

select tintseq(ARRAY[
tintinst(1, '2012-01-01 08:00:00'),
tintinst(2, '2012-01-01 08:10:00'),
tintinst(3, '2012-01-01 08:20:00')
]);

select tfloatseq(ARRAY[
tfloatinst(1, '2012-01-01 08:00:00'),
tfloatinst(2, '2012-01-01 08:10:00'),
tfloatinst(3, '2012-01-01 08:20:00')
]);

select ttextseq(ARRAY[
ttextinst('A', '2012-01-01 08:00:00'),
ttextinst('B', '2012-01-01 08:10:00'),
ttextinst('C', '2012-01-01 08:20:00')
]);

-------------------------------------------------------------------------------

select tbools(ARRAY[
tboolseq(ARRAY[
tboolinst(true, '2012-01-01 08:00:00'),
tboolinst(false, '2012-01-01 08:10:00'),
tboolinst(true, '2012-01-01 08:20:00')
]),
tboolseq(ARRAY[
tboolinst(true, '2012-01-01 09:00:00'),
tboolinst(false, '2012-01-01 09:10:00'),
tboolinst(true, '2012-01-01 09:20:00')
])]);

select tints(ARRAY[
tintseq(ARRAY[
tintinst(1, '2012-01-01 08:00:00'),
tintinst(2, '2012-01-01 08:10:00'),
tintinst(3, '2012-01-01 08:20:00')
]),
tintseq(ARRAY[
tintinst(1, '2012-01-01 09:00:00'),
tintinst(2, '2012-01-01 09:10:00'),
tintinst(1, '2012-01-01 09:20:00')
])]);

select tfloats(ARRAY[
tfloatseq(ARRAY[
tfloatinst(1, '2012-01-01 08:00:00'),
tfloatinst(2, '2012-01-01 08:10:00'),
tfloatinst(3, '2012-01-01 08:20:00')
]),
tfloatseq(ARRAY[
tfloatinst(1, '2012-01-01 09:00:00'),
tfloatinst(2, '2012-01-01 09:10:00'),
tfloatinst(1, '2012-01-01 09:20:00')
])]);

select ttexts(ARRAY[
ttextseq(ARRAY[
ttextinst('A', '2012-01-01 08:00:00'),
ttextinst('B', '2012-01-01 08:10:00'),
ttextinst('C', '2012-01-01 08:20:00')
]),
ttextseq(ARRAY[
ttextinst('A', '2012-01-01 09:00:00'),
ttextinst('B', '2012-01-01 09:10:00'),
ttextinst('C', '2012-01-01 09:20:00')
])]);

-------------------------------------------------------------------------------
-- Cast functions
-------------------------------------------------------------------------------

SELECT tfloat(tint '1@2001-01-01');
SELECT tfloat(tint '{1@2001-01-01, 2@2001-01-02}');
SELECT tfloat(tint '[1@2001-01-01, 1@2001-01-02]');
SELECT tfloat(tint '{[1@2001-01-01, 1@2001-01-02], [2@2001-01-03, 2@2001-01-04]}');

-------------------------------------------------------------------------------
-- Transformation functions
-------------------------------------------------------------------------------

SELECT tboolinst(tbool 'true@2001-01-01');
SELECT tboolinst(tbool '{true@2001-01-01}');
SELECT tboolinst(tbool '[true@2001-01-01]');
SELECT tboolinst(tbool '{[true@2001-01-01]}');

/* Error 
SELECT tboolinst(tbool '{true@2001-01-01, true@2001-01-02}');
SELECT tboolinst(tbool '[true@2001-01-01, true@2001-01-02]');
SELECT tboolinst(tbool '{[true@2001-01-01, true@2001-01-02]}');
SELECT tboolinst(tbool '{[true@2001-01-01], [true@2001-01-02]}');
*/

SELECT tbooli(tbool 'true@2001-01-01');
SELECT tbooli(tbool '{true@2001-01-01, true@2001-01-02}');
SELECT tbooli(tbool '[true@2001-01-01]');
SELECT tbooli(tbool '{[true@2001-01-01], [false@2001-01-02]}');

/* Error 
SELECT tbooli(tbool '[true@2001-01-01, true@2001-01-02]');
SELECT tbooli(tbool '{[true@2001-01-01, true@2001-01-02]}');
*/

SELECT tboolseq(tbool 'true@2001-01-01');
SELECT tboolseq(tbool '{true@2001-01-01}');
SELECT tboolseq(tbool '[true@2001-01-01, true@2001-01-02]');
SELECT tboolseq(tbool '{[true@2001-01-01, false@2001-01-02]}');

/* Error 
SELECT tboolseq(tbool '{true@2001-01-01, true@2001-01-02}');
SELECT tboolseq(tbool '{[true@2001-01-01], [false@2001-01-02]}');
*/

SELECT tbools(tbool 'true@2001-01-01');
SELECT tbools(tbool '{true@2001-01-01, true@2001-01-02}');
SELECT tbools(tbool '[true@2001-01-01, true@2001-01-02]');
SELECT tbools(tbool '{[true@2001-01-01, false@2001-01-02]}');

-------------------------------------------------------------------------------
-- Accessor functions
-------------------------------------------------------------------------------

select temporalType(tbool 'FALSE@2012-01-01 08:00:00');
select temporalType(tint '1@2012-01-01 08:00:00');
select temporalType(tfloat '1@2012-01-01 08:00:00');
select temporalType(ttext 'AAA@2012-01-01 08:00:00');

select temporalType(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}');
select temporalType(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select temporalType(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select temporalType(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}');

select temporalType(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]');
select temporalType(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]');
select temporalType(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]');
select temporalType(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]');

select temporalType(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}');
select temporalType(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}');
select temporalType(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}');
select temporalType(ttext '{[AAA@2001-01-01 08:00:00,BBB@2001-01-01 08:05:00,CCC@2001-01-01 08:06:00],
 [AAA@2001-01-01 09:00:00,BBB@2001-01-01 09:05:00,CCC@2001-01-01 09:06:00]}');

-------------------------------------------------------------------------------

select memSize(tbool 'FALSE@2012-01-01 08:00:00');
select memSize(tint '1@2012-01-01 08:00:00');
select memSize(tfloat '1@2012-01-01 08:00:00');
select memSize(ttext 'AAA@2012-01-01 08:00:00');

select memSize(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}');
select memSize(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select memSize(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select memSize(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}');

select memSize(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]');
select memSize(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]');
select memSize(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]');
select memSize(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]');

select memSize(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}');
select memSize(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}');
select memSize(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}');
select memSize(ttext '{[AAA@2001-01-01 08:00:00,BBB@2001-01-01 08:05:00,CCC@2001-01-01 08:06:00],
 [AAA@2001-01-01 09:00:00,BBB@2001-01-01 09:05:00,CCC@2001-01-01 09:06:00]}');

-------------------------------------------------------------------------------

select getValue(tboolinst(TRUE, '2012-01-01 08:00:00'));
select getValue(tintinst(1, '2012-01-01 08:00:00'));
select getValue(tfloatinst(1, '2012-01-01 08:00:00'));
select getValue(ttextinst('AAA', '2012-01-01 08:00:00'));

-------------------------------------------------------------------------------

SELECT getValues(tint '1@2012-01-01');
SELECT getValues(tint '{1@2012-01-01, 2@2012-01-03}');
SELECT getValues(tint '[1@2012-01-01, 2@2012-01-03]');
SELECT getValues(tint '{[1@2012-01-01, 2@2012-01-03], [3@2012-01-04, 2@2012-01-05]}');

SELECT getValues(tfloat '1@2012-01-01');
SELECT getValues(tfloat '{1@2012-01-01, 2@2012-01-03}');
SELECT getValues(tfloat '[1@2012-01-01, 2@2012-01-03)');
SELECT getValues(tfloat '{[1@2012-01-01, 2@2012-01-03), [3@2012-01-04, 2@2012-01-05]}');

-------------------------------------------------------------------------------

select getTime(tbool 'FALSE@2012-01-01 08:00:00');
select getTime(tint '1@2012-01-01 08:00:00');
select getTime(tfloat '1@2012-01-01 08:00:00');
select getTime(ttext 'AAA@2012-01-01 08:00:00');

select getTime(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}');
select getTime(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select getTime(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select getTime(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}');

select getTime(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]');
select getTime(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]');
select getTime(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]');
select getTime(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]');

select getTime(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}');
select getTime(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}');
select getTime(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}');
select getTime(ttext '{[AAA@2001-01-01 08:00:00,BBB@2001-01-01 08:05:00,CCC@2001-01-01 08:06:00],
 [AAA@2001-01-01 09:00:00,BBB@2001-01-01 09:05:00,CCC@2001-01-01 09:06:00]}');

-------------------------------------------------------------------------------

select getTimestamp(tboolinst(TRUE, '2012-01-01 08:00:00'));
select getTimestamp(tintinst(1, '2012-01-01 08:00:00'));
select getTimestamp(tfloatinst(1, '2012-01-01 08:00:00'));
select getTimestamp(ttextinst('AAA', '2012-01-01 08:00:00'));

-------------------------------------------------------------------------------

select ever_equals(tbool 'FALSE@2012-01-01 08:00:00', true);
select ever_equals(tint '1@2012-01-01 08:00:00', 1);
select ever_equals(tfloat '1@2012-01-01 08:00:00', 1);
select ever_equals(ttext 'AAA@2012-01-01 08:00:00', 'AAA');

select ever_equals(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', true);
select ever_equals(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 1);
select ever_equals(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 1);
select ever_equals(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}', 'AAA');

select ever_equals(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', true);
select ever_equals(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', 1);
select ever_equals(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', 1);
select ever_equals(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]', 'AAA');

select ever_equals(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', true);
select ever_equals(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', 1);
select ever_equals(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', 1);
select ever_equals(ttext '{[AAA@2001-01-01 08:00:00,BBB@2001-01-01 08:05:00,CCC@2001-01-01 08:06:00],
 [AAA@2001-01-01 09:00:00,BBB@2001-01-01 09:05:00,CCC@2001-01-01 09:06:00]}', 'AAA');

select tbool 'FALSE@2012-01-01 08:00:00' &= true;
select tint '1@2012-01-01 08:00:00' &= 1;
select tfloat '1@2012-01-01 08:00:00' &= 1;
select ttext 'AAA@2012-01-01 08:00:00' &= 'AAA';

select tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}' &= true;
select tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}' &= 1;
select tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}' &= 1;
select ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}' &= 'AAA';

select tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]' &= true;
select tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]' &= 1;
select tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]' &= 1;
select ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]' &= 'AAA';

select tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}' &= true;
select tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}' &= 1;
select tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}' &= 1;
select ttext '{[AAA@2001-01-01 08:00:00,BBB@2001-01-01 08:05:00,CCC@2001-01-01 08:06:00],
 [AAA@2001-01-01 09:00:00,BBB@2001-01-01 09:05:00,CCC@2001-01-01 09:06:00]}' &= 'AAA';

-------------------------------------------------------------------------------

select always_equals(tbool 'FALSE@2012-01-01 08:00:00', true);
select always_equals(tint '1@2012-01-01 08:00:00', 1);
select always_equals(tfloat '1@2012-01-01 08:00:00', 1);
select always_equals(ttext 'AAA@2012-01-01 08:00:00', 'AAA');

select always_equals(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', true);
select always_equals(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 1);
select always_equals(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 1);
select always_equals(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}', 'AAA');

select always_equals(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', true);
select always_equals(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', 1);
select always_equals(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', 1);
select always_equals(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]', 'AAA');

select always_equals(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', true);
select always_equals(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', 1);
select always_equals(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', 1);
select always_equals(ttext '{[AAA@2001-01-01 08:00:00,BBB@2001-01-01 08:05:00,CCC@2001-01-01 08:06:00],
 [AAA@2001-01-01 09:00:00,BBB@2001-01-01 09:05:00,CCC@2001-01-01 09:06:00]}', 'AAA');

select tbool 'FALSE@2012-01-01 08:00:00' @= true;
select tint '1@2012-01-01 08:00:00' @= 1;
select tfloat '1@2012-01-01 08:00:00' @= 1;
select ttext 'AAA@2012-01-01 08:00:00' @= 'AAA';

select tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}' @= true;
select tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}' @= 1;
select tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}' @= 1;
select ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}' @= 'AAA';

select tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]' @= true;
select tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]' @= 1;
select tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]' @= 1;
select ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]' @= 'AAA';

select tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}' @= true;
select tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}' @= 1;
select tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}' @= 1;
select ttext '{[AAA@2001-01-01 08:00:00,BBB@2001-01-01 08:05:00,CCC@2001-01-01 08:06:00],
 [AAA@2001-01-01 09:00:00,BBB@2001-01-01 09:05:00,CCC@2001-01-01 09:06:00]}' @= 'AAA';

-------------------------------------------------------------------------------

select shift(tbool 'FALSE@2012-01-01 08:00:00', interval '5 min');
select shift(tint '1@2012-01-01 08:00:00', interval '5 min');
select shift(tfloat '1@2012-01-01 08:00:00', interval '5 min');
select shift(ttext 'AAA@2012-01-01 08:00:00', interval '5 min');

select shift(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', interval '5 min');
select shift(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', interval '5 min');
select shift(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', interval '5 min');
select shift(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}', interval '5 min');

select shift(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', interval '5 min');
select shift(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', interval '5 min');
select shift(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', interval '5 min');
select shift(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]', interval '5 min');

select shift(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', interval '5 min');
select shift(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', interval '5 min');
select shift(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', interval '5 min');
select shift(ttext '{[AAA@2001-01-01 08:00:00,BBB@2001-01-01 08:05:00,CCC@2001-01-01 08:06:00],
 [AAA@2001-01-01 09:00:00,BBB@2001-01-01 09:05:00,CCC@2001-01-01 09:06:00]}', interval '5 min');

-------------------------------------------------------------------------------

select atValue(tbool 'FALSE@2012-01-01 08:00:00', true);
select atValue(tbool 'FALSE@2012-01-01 08:00:00', false);
select atValue(tint '1@2012-01-01 08:00:00', 1);
select atValue(tint '1@2012-01-01 08:00:00', 2);
select atValue(tfloat '1@2012-01-01 08:00:00', 1);
select atValue(tfloat '1@2012-01-01 08:00:00', 2);
select atValue(ttext 'A@2012-01-01 08:00:00', 'A');
select atValue(ttext 'A@2012-01-01 08:00:00', 'B');

select atValue(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', true);
select atValue(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 1);
select atValue(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 4);
select atValue(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 1);
select atValue(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 4);
select atValue(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}', 'A');
select atValue(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}', 'D');

select atValue(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', true);
select atValue(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', 1);
select atValue(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', 4);
select atValue(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', 1);
select atValue(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', 4);
select atValue(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]', 'A');
select atValue(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]', 'D');

select atValue(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', true);
select atValue(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', 1);
select atValue(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', 4);
select atValue(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', 1);
select atValue(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', 4);
select atValue(ttext '{[A@2001-01-01 08:00:00,BBB@2001-01-01 08:05:00,CCC@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,BBB@2001-01-01 09:05:00,CCC@2001-01-01 09:06:00]}', 'A');
select atValue(ttext '{[A@2001-01-01 08:00:00,BBB@2001-01-01 08:05:00,CCC@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,BBB@2001-01-01 09:05:00,CCC@2001-01-01 09:06:00]}', 'D');

-------------------------------------------------------------------------------

select minusValue(tbool 'FALSE@2012-01-01 08:00:00', true);
select minusValue(tbool 'FALSE@2012-01-01 08:00:00', false);
select minusValue(tint '1@2012-01-01 08:00:00', 1);
select minusValue(tint '1@2012-01-01 08:00:00', 2);
select minusValue(tfloat '1@2012-01-01 08:00:00', 1);
select minusValue(tfloat '1@2012-01-01 08:00:00', 2);
select minusValue(ttext 'A@2012-01-01 08:00:00', 'A');
select minusValue(ttext 'A@2012-01-01 08:00:00', 'B');

select minusValue(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', true);
select minusValue(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 1);
select minusValue(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 4);
select minusValue(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 1);
select minusValue(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 4);
select minusValue(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}', 'A');
select minusValue(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}', 'D');

select minusValue(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', true);
select minusValue(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', 1);
select minusValue(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', 4);
select minusValue(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', 1);
select minusValue(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', 4);
select minusValue(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]', 'A');
select minusValue(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]', 'D');

select minusValue(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', true);
select minusValue(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', 1);
select minusValue(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', 4);
select minusValue(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', 1);
select minusValue(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', 4);
select minusValue(ttext '{[A@2001-01-01 08:00:00,BBB@2001-01-01 08:05:00,CCC@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,BBB@2001-01-01 09:05:00,CCC@2001-01-01 09:06:00]}', 'A');
select minusValue(ttext '{[A@2001-01-01 08:00:00,BBB@2001-01-01 08:05:00,CCC@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,BBB@2001-01-01 09:05:00,CCC@2001-01-01 09:06:00]}', 'D');

-------------------------------------------------------------------------------

select atValues(tbool 'FALSE@2012-01-01 08:00:00', ARRAY[TRUE,FALSE]);
select atValues(tbool 'FALSE@2012-01-01 08:00:00', ARRAY[TRUE]);
select atValues(tint '1@2012-01-01 08:00:00', ARRAY[1,2,3]);
select atValues(tint '1@2012-01-01 08:00:00', ARRAY[2,3,4]);
select atValues(tint '1@2012-01-01 08:00:00', ARRAY[4,5,6]);
select atValues(tfloat '1@2012-01-01 08:00:00', ARRAY[1,2,3]);
select atValues(tfloat '1@2012-01-01 08:00:00', ARRAY[2,3,4]);
select atValues(tfloat '1@2012-01-01 08:00:00', ARRAY[4,5,6]);
select atValues(ttext 'A@2012-01-01 08:00:00', ARRAY['A','B','C']);
select atValues(ttext 'A@2012-01-01 08:00:00', ARRAY['B','C','D']);
select atValues(ttext 'A@2012-01-01 08:00:00', ARRAY['D','E','F']);

select atValues(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', ARRAY[TRUE,FALSE]);
select atValues(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', ARRAY[FALSE]);
select atValues(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[1,2,3]);
select atValues(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[2,3,4]);
select atValues(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[4,5,6]);
select atValues(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[1,2,3]);
select atValues(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[2,3,4]);
select atValues(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[4,5,6]);
select atValues(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}', ARRAY['A','B','C']);
select atValues(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}', ARRAY['B','C','D']);
select atValues(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}', ARRAY['D','E','F']);

select atValues(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', ARRAY[TRUE,FALSE]);
select atValues(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', ARRAY[FALSE]);
select atValues(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[1,2,3]);
select atValues(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[2,3,4]);
select atValues(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[4,5,6]);
select atValues(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[1,2,3]);
select atValues(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[2,3,4]);
select atValues(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[4,5,6]);
select atValues(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]', ARRAY['A','B','C']);
select atValues(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]', ARRAY['B','C','D']);
select atValues(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]', ARRAY['D','E','F']);

select atValues(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', ARRAY[TRUE,FALSE]);
select atValues(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', ARRAY[FALSE]);
select atValues(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[1,2,3]);
select atValues(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[2,3,4]);
select atValues(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[4,5,6]);
select atValues(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[1,2,3]);
select atValues(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[2,3,4]);
select atValues(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[4,5,6]);
select atValues(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', ARRAY['A','B','C']);
select atValues(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', ARRAY['B','C','D']);
select atValues(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', ARRAY['D','E','F']);

-------------------------------------------------------------------------------

select minusValues(tbool 'FALSE@2012-01-01 08:00:00', ARRAY[TRUE,FALSE]);
select minusValues(tbool 'FALSE@2012-01-01 08:00:00', ARRAY[TRUE]);
select minusValues(tint '1@2012-01-01 08:00:00', ARRAY[1,2,3]);
select minusValues(tint '1@2012-01-01 08:00:00', ARRAY[2,3,4]);
select minusValues(tint '1@2012-01-01 08:00:00', ARRAY[4,5,6]);
select minusValues(tfloat '1@2012-01-01 08:00:00', ARRAY[1,2,3]);
select minusValues(tfloat '1@2012-01-01 08:00:00', ARRAY[2,3,4]);
select minusValues(tfloat '1@2012-01-01 08:00:00', ARRAY[4,5,6]);
select minusValues(ttext 'A@2012-01-01 08:00:00', ARRAY['A','B','C']);
select minusValues(ttext 'A@2012-01-01 08:00:00', ARRAY['B','C','D']);
select minusValues(ttext 'A@2012-01-01 08:00:00', ARRAY['D','E','F']);

select minusValues(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', ARRAY[TRUE,FALSE]);
select minusValues(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', ARRAY[FALSE]);
select minusValues(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[1,2,3]);
select minusValues(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[2,3,4]);
select minusValues(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[4,5,6]);
select minusValues(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[1,2,3]);
select minusValues(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[2,3,4]);
select minusValues(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[4,5,6]);
select minusValues(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}', ARRAY['A','B','C']);
select minusValues(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}', ARRAY['B','C','D']);
select minusValues(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00}', ARRAY['D','E','F']);

select minusValues(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', ARRAY[TRUE,FALSE]);
select minusValues(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', ARRAY[FALSE]);
select minusValues(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[1,2,3]);
select minusValues(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[2,3,4]);
select minusValues(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[4,5,6]);
select minusValues(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[1,2,3]);
select minusValues(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[2,3,4]);
select minusValues(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[4,5,6]);
select minusValues(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]', ARRAY['A','B','C']);
select minusValues(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]', ARRAY['B','C','D']);
select minusValues(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00]', ARRAY['D','E','F']);

select minusValues(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', ARRAY[TRUE,FALSE]);
select minusValues(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', ARRAY[FALSE]);
select minusValues(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[1,2,3]);
select minusValues(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[2,3,4]);
select minusValues(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[4,5,6]);
select minusValues(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[1,2,3]);
select minusValues(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[2,3,4]);
select minusValues(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[4,5,6]);
select minusValues(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', ARRAY['A','B','C']);
select minusValues(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', ARRAY['B','C','D']);
select minusValues(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', ARRAY['D','E','F']);

-------------------------------------------------------------------------------

select atRange(tint '1@2012-01-01 08:00:00', intrange '[1,3]');
select atRange(tint '1@2012-01-01 08:00:00', intrange '[2,4]');
select atRange(tfloat '1@2012-01-01 08:00:00', floatrange '[1,3]');
select atRange(tfloat '1@2012-01-01 08:00:00', floatrange '[2,4]');

select atRange(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', intrange '[1,3]');
select atRange(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', intrange '[2,4]');
select atRange(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', intrange '[4,6]');
select atRange(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', floatrange '[1,3]');
select atRange(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', floatrange '[2,4]');
select atRange(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', floatrange '[4,6]');

select atRange(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', intrange '[1,3]');
select atRange(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', intrange '[2,4]');
select atRange(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', intrange '[4,6]');
select atRange(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', floatrange '[1,3]');
select atRange(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', floatrange '[2,4]');
select atRange(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', floatrange '[4,6]');

select atRange(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', intrange '[1,3]');
select atRange(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', intrange '[2,4]');
select atRange(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', intrange '[4,6]');
select atRange(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', floatrange '[1,3]');
select atRange(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', floatrange '[2,4]');
select atRange(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', floatrange '[4,6]');

-------------------------------------------------------------------------------

select minusRange(tint '1@2012-01-01 08:00:00', intrange '[1,3]');
select minusRange(tint '1@2012-01-01 08:00:00', intrange '[2,4]');
select minusRange(tfloat '1@2012-01-01 08:00:00', floatrange '[1,3]');
select minusRange(tfloat '1@2012-01-01 08:00:00', floatrange '[2,4]');

select minusRange(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', intrange '[1,3]');
select minusRange(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', intrange '[2,4]');
select minusRange(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', intrange '[4,6]');
select minusRange(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', floatrange '[1,3]');
select minusRange(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', floatrange '[2,4]');
select minusRange(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', floatrange '[4,6]');

select minusRange(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', intrange '[1,3]');
select minusRange(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', intrange '[2,4]');
select minusRange(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', intrange '[4,6]');
select minusRange(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', floatrange '[1,3]');
select minusRange(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', floatrange '[2,4]');
select minusRange(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', floatrange '[4,6]');

select minusRange(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', intrange '[1,3]');
select minusRange(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', intrange '[2,4]');
select minusRange(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', intrange '[4,6]');
select minusRange(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', floatrange '[1,3]');
select minusRange(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', floatrange '[2,4]');
select minusRange(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', floatrange '[4,6]');

-------------------------------------------------------------------------------

select atRanges(tint '1@2012-01-01 08:00:00', ARRAY[intrange '[1,3]', '[4,6]', '[6,7]']);
select atRanges(tint '1@2012-01-01 08:00:00', ARRAY[intrange '[2,4]', '[5,7]']);
select atRanges(tfloat '1@2012-01-01 08:00:00', ARRAY[floatrange '[1,3]', '[4,6]', '[6,7]']);
select atRanges(tfloat '1@2012-01-01 08:00:00', ARRAY[floatrange '[2,4]', '[5,7]']);

select atRanges(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[intrange '[1,3]', '[4,6]', '[6,7]']);
select atRanges(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[intrange '[2,4]', '[5,7]']);
select atRanges(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[intrange '[4,6]', '[6,7]']);
select atRanges(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[floatrange '[1,3]', '[4,6]', '[6,7]']);
select atRanges(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[floatrange '[2,4]', '[5,7]']);
select atRanges(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[floatrange '[4,6]', '[6,7]']);

select atRanges(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[intrange '[1,3]', '[4,6]', '[6,7]']);
select atRanges(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[intrange '[2,4]', '[5,7]']);
select atRanges(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[intrange '[4,6]', '[6,7]']);
select atRanges(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[floatrange '[1,3]', '[4,6]', '[6,7]']);
select atRanges(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[floatrange '[2,4]', '[5,7]']);
select atRanges(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[floatrange '[4,6]', '[6,7]']);

select atRanges(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[intrange '[1,3]', '[4,6]', '[6,7]']);
select atRanges(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[intrange '[2,4]', '[5,7]']);
select atRanges(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[intrange '[4,6]', '[6,7]']);
select atRanges(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[floatrange '[1,3]', '[4,6]', '[6,7]']);
select atRanges(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[floatrange '[2,4]', '[5,7]']);
select atRanges(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[floatrange '[4,6]', '[6,7]']);

-------------------------------------------------------------------------------

select minusRanges(tint '1@2012-01-01 08:00:00', ARRAY[intrange '[1,3]', '[4,6]', '[6,7]']);
select minusRanges(tint '1@2012-01-01 08:00:00', ARRAY[intrange '[2,4]', '[5,7]']);
select minusRanges(tfloat '1@2012-01-01 08:00:00', ARRAY[floatrange '[1,3]', '[4,6]', '[6,7]']);
select minusRanges(tfloat '1@2012-01-01 08:00:00', ARRAY[floatrange '[2,4]', '[5,7]']);

select minusRanges(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[intrange '[1,3]', '[4,6]', '[6,7]']);
select minusRanges(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[intrange '[2,4]', '[5,7]']);
select minusRanges(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[intrange '[4,6]', '[6,7]']);
select minusRanges(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[floatrange '[1,3]', '[4,6]', '[6,7]']);
select minusRanges(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[floatrange '[2,4]', '[5,7]']);
select minusRanges(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', ARRAY[floatrange '[4,6]', '[6,7]']);

select minusRanges(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[intrange '[1,3]', '[4,6]', '[6,7]']);
select minusRanges(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[intrange '[2,4]', '[5,7]']);
select minusRanges(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[intrange '[4,6]', '[6,7]']);
select minusRanges(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[floatrange '[1,3]', '[4,6]', '[6,7]']);
select minusRanges(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[floatrange '[2,4]', '[5,7]']);
select minusRanges(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', ARRAY[floatrange '[4,6]', '[6,7]']);

select minusRanges(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[intrange '[1,3]', '[4,6]', '[6,7]']);
select minusRanges(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[intrange '[2,4]', '[5,7]']);
select minusRanges(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[intrange '[4,6]', '[6,7]']);
select minusRanges(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[floatrange '[1,3]', '[4,6]', '[6,7]']);
select minusRanges(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[floatrange '[2,4]', '[5,7]']);
select minusRanges(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', ARRAY[floatrange '[4,6]', '[6,7]']);

-------------------------------------------------------------------------------

select atTimestamp(tbool 'FALSE@2012-01-01 08:00:00', '2012-01-01 08:00:00');
select atTimestamp(tbool 'FALSE@2012-01-01 08:00:00', '2012-01-01 08:05:00');
select atTimestamp(tint '1@2012-01-01 08:00:00', '2012-01-01 08:00:00');
select atTimestamp(tint '1@2012-01-01 08:00:00', '2012-01-01 08:05:00');
select atTimestamp(tfloat '1@2012-01-01 08:00:00', '2012-01-01 08:00:00');
select atTimestamp(tfloat '1@2012-01-01 08:00:00', '2012-01-01 08:05:00');
select atTimestamp(ttext 'A@2012-01-01 08:00:00', '2012-01-01 08:00:00');
select atTimestamp(ttext 'A@2012-01-01 08:00:00', '2012-01-01 08:05:00');

select atTimestamp(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '2012-01-01 08:00:00');
select atTimestamp(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '2012-01-01 08:05:00');
select atTimestamp(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '2012-01-01 08:10:00');
select atTimestamp(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '2012-01-01 08:00:00');
select atTimestamp(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '2012-01-01 08:05:00');
select atTimestamp(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '2012-01-01 08:10:00');
select atTimestamp(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '2012-01-01 08:00:00');
select atTimestamp(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '2012-01-01 08:05:00');
select atTimestamp(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '2012-01-01 08:10:00');
select atTimestamp(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '2012-01-01 08:00:00');
select atTimestamp(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '2012-01-01 08:05:00');
select atTimestamp(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '2012-01-01 08:10:00');

select atTimestamp(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '2012-01-01 08:00:00');
select atTimestamp(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '2012-01-01 08:05:00');
select atTimestamp(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '2012-01-01 08:10:00');
select atTimestamp(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '2012-01-01 08:00:00');
select atTimestamp(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '2012-01-01 08:05:00');
select atTimestamp(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '2012-01-01 08:10:00');
select atTimestamp(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '2012-01-01 08:00:00');
select atTimestamp(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '2012-01-01 08:05:00');
select atTimestamp(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '2012-01-01 08:10:00');
select atTimestamp(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '2012-01-01 08:00:00');
select atTimestamp(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '2012-01-01 08:05:00');
select atTimestamp(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '2012-01-01 08:10:00');

select atTimestamp(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '2012-01-01 08:00:00');
select atTimestamp(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '2012-01-01 08:05:00');
select atTimestamp(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '2012-01-01 08:10:00');
select atTimestamp(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '2012-01-01 08:00:00');
select atTimestamp(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '2012-01-01 08:05:00');
select atTimestamp(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '2012-01-01 08:10:00');
select atTimestamp(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '2012-01-01 08:00:00');
select atTimestamp(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '2012-01-01 08:05:00');
select atTimestamp(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '2012-01-01 08:10:00');
select atTimestamp(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '2012-01-01 08:00:00');
select atTimestamp(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '2012-01-01 08:05:00');
select atTimestamp(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '2012-01-01 08:10:00');

-------------------------------------------------------------------------------

select minusTimestamp(tint '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '2000-01-01');
select minusTimestamp(tint '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '2000-01-02');
select minusTimestamp(tint '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '2000-01-03');
select minusTimestamp(tint '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '2000-01-04');
select minusTimestamp(tint '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '2000-01-05');
select minusTimestamp(tint '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '2000-01-06');
select minusTimestamp(tint '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '2000-01-07');

select minusTimestamp(tfloat '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '2000-01-01');
select minusTimestamp(tfloat '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '2000-01-02');
select minusTimestamp(tfloat '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '2000-01-03');
select minusTimestamp(tfloat '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '2000-01-04');
select minusTimestamp(tfloat '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '2000-01-05');
select minusTimestamp(tfloat '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '2000-01-06');
select minusTimestamp(tfloat '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '2000-01-07');

-------------------------------------------------------------------------------

select minusTimestampSet(tint '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '{2000-01-01, 2000-01-02}');
select minusTimestampSet(tint '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '{2000-01-02, 2000-01-03}');
select minusTimestampSet(tint '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '{2000-01-03, 2000-01-04}');
select minusTimestampSet(tint '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '{2000-01-04, 2000-01-05}');
select minusTimestampSet(tint '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '{2000-01-05, 2000-01-06}');
select minusTimestampSet(tint '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '{2000-01-06, 2000-01-07}');
select minusTimestampSet(tint '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '{2000-01-07, 2000-01-08}');
select minusTimestampSet(tint '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '{2000-01-08, 2000-01-09}');

select minusTimestampSet(tfloat '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '{2000-01-01, 2000-01-02}');
select minusTimestampSet(tfloat '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '{2000-01-02, 2000-01-03}');
select minusTimestampSet(tfloat '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '{2000-01-03, 2000-01-04}');
select minusTimestampSet(tfloat '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '{2000-01-04, 2000-01-05}');
select minusTimestampSet(tfloat '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '{2000-01-05, 2000-01-06}');
select minusTimestampSet(tfloat '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '{2000-01-06, 2000-01-07}');
select minusTimestampSet(tfloat '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '{2000-01-07, 2000-01-08}');
select minusTimestampSet(tfloat '[1@2000-01-01, 2@2000-01-03, 1@2000-01-05, 4@2000-01-07]', '{2000-01-08, 2000-01-09}');

-------------------------------------------------------------------------------

select minusTimestamp(tbool 'FALSE@2012-01-01 08:00:00', '2012-01-01 08:00:00');
select minusTimestamp(tbool 'FALSE@2012-01-01 08:00:00', '2012-01-01 08:05:00');
select minusTimestamp(tint '1@2012-01-01 08:00:00', '2012-01-01 08:00:00');
select minusTimestamp(tint '1@2012-01-01 08:00:00', '2012-01-01 08:05:00');
select minusTimestamp(tfloat '1@2012-01-01 08:00:00', '2012-01-01 08:00:00');
select minusTimestamp(tfloat '1@2012-01-01 08:00:00', '2012-01-01 08:05:00');
select minusTimestamp(ttext 'A@2012-01-01 08:00:00', '2012-01-01 08:00:00');
select minusTimestamp(ttext 'A@2012-01-01 08:00:00', '2012-01-01 08:05:00');

select minusTimestamp(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '2012-01-01 08:00:00');
select minusTimestamp(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '2012-01-01 08:05:00');
select minusTimestamp(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '2012-01-01 08:10:00');
select minusTimestamp(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '2012-01-01 08:00:00');
select minusTimestamp(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '2012-01-01 08:05:00');
select minusTimestamp(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '2012-01-01 08:10:00');
select minusTimestamp(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '2012-01-01 08:00:00');
select minusTimestamp(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '2012-01-01 08:05:00');
select minusTimestamp(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '2012-01-01 08:10:00');
select minusTimestamp(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '2012-01-01 08:00:00');
select minusTimestamp(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '2012-01-01 08:05:00');
select minusTimestamp(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '2012-01-01 08:10:00');

select minusTimestamp(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '2012-01-01 08:00:00');
select minusTimestamp(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '2012-01-01 08:05:00');
select minusTimestamp(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '2012-01-01 08:10:00');
select minusTimestamp(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '2012-01-01 08:00:00');
select minusTimestamp(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '2012-01-01 08:05:00');
select minusTimestamp(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '2012-01-01 08:10:00');
select minusTimestamp(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '2012-01-01 08:00:00');
select minusTimestamp(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '2012-01-01 08:05:00');
select minusTimestamp(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '2012-01-01 08:10:00');
select minusTimestamp(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '2012-01-01 08:00:00');
select minusTimestamp(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '2012-01-01 08:05:00');
select minusTimestamp(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '2012-01-01 08:10:00');

select minusTimestamp(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '2012-01-01 08:00:00');
select minusTimestamp(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '2012-01-01 08:05:00');
select minusTimestamp(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '2012-01-01 08:10:00');
select minusTimestamp(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '2012-01-01 08:00:00');
select minusTimestamp(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '2012-01-01 08:05:00');
select minusTimestamp(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '2012-01-01 08:10:00');
select minusTimestamp(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '2012-01-01 08:00:00');
select minusTimestamp(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '2012-01-01 08:05:00');
select minusTimestamp(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '2012-01-01 08:10:00');
select minusTimestamp(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '2012-01-01 08:00:00');
select minusTimestamp(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '2012-01-01 08:05:00');
select minusTimestamp(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '2012-01-01 08:10:00');

-------------------------------------------------------------------------------

select atTimestampSet(tbool 'FALSE@2012-01-01 08:00:00', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select atTimestampSet(tbool 'FALSE@2012-01-01 08:00:00', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select atTimestampSet(tint '1@2012-01-01 08:00:00', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select atTimestampSet(tint '1@2012-01-01 08:00:00', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select atTimestampSet(tfloat '1@2012-01-01 08:00:00', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select atTimestampSet(tfloat '1@2012-01-01 08:00:00', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select atTimestampSet(ttext 'A@2012-01-01 08:00:00', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select atTimestampSet(ttext 'A@2012-01-01 08:00:00', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');

select atTimestampSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select atTimestampSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select atTimestampSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select atTimestampSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select atTimestampSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select atTimestampSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select atTimestampSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select atTimestampSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select atTimestampSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select atTimestampSet(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select atTimestampSet(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select atTimestampSet(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');

select atTimestampSet(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select atTimestampSet(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select atTimestampSet(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select atTimestampSet(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select atTimestampSet(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select atTimestampSet(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select atTimestampSet(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select atTimestampSet(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select atTimestampSet(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select atTimestampSet(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select atTimestampSet(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select atTimestampSet(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');

select atTimestampSet(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select atTimestampSet(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select atTimestampSet(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select atTimestampSet(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select atTimestampSet(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select atTimestampSet(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select atTimestampSet(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select atTimestampSet(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select atTimestampSet(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select atTimestampSet(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select atTimestampSet(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select atTimestampSet(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');

-------------------------------------------------------------------------------

select minusTimestampSet(tbool 'FALSE@2012-01-01 08:00:00', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select minusTimestampSet(tbool 'FALSE@2012-01-01 08:00:00', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select minusTimestampSet(tint '1@2012-01-01 08:00:00', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select minusTimestampSet(tint '1@2012-01-01 08:00:00', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select minusTimestampSet(tfloat '1@2012-01-01 08:00:00', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select minusTimestampSet(tfloat '1@2012-01-01 08:00:00', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select minusTimestampSet(ttext 'A@2012-01-01 08:00:00', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select minusTimestampSet(ttext 'A@2012-01-01 08:00:00', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');

select minusTimestampSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select minusTimestampSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select minusTimestampSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select minusTimestampSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select minusTimestampSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select minusTimestampSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select minusTimestampSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select minusTimestampSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select minusTimestampSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select minusTimestampSet(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select minusTimestampSet(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select minusTimestampSet(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');

select minusTimestampSet(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select minusTimestampSet(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select minusTimestampSet(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select minusTimestampSet(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select minusTimestampSet(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select minusTimestampSet(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select minusTimestampSet(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select minusTimestampSet(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select minusTimestampSet(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select minusTimestampSet(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select minusTimestampSet(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select minusTimestampSet(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');

select minusTimestampSet(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select minusTimestampSet(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select minusTimestampSet(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select minusTimestampSet(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select minusTimestampSet(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select minusTimestampSet(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select minusTimestampSet(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select minusTimestampSet(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select minusTimestampSet(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');
select minusTimestampSet(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '{2012-01-01 08:00:00, 2012-01-01 08:01:00}');
select minusTimestampSet(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '{2012-01-01 08:05:00, 2012-01-01 08:06:00}');
select minusTimestampSet(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '{2012-01-01 08:10:00, 2012-01-01 08:11:00}');

-------------------------------------------------------------------------------

select atPeriod(tbool 'FALSE@2012-01-01 08:00:00', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select atPeriod(tbool 'FALSE@2012-01-01 08:00:00', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select atPeriod(tint '1@2012-01-01 08:00:00', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select atPeriod(tint '1@2012-01-01 08:00:00', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select atPeriod(tfloat '1@2012-01-01 08:00:00', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select atPeriod(tfloat '1@2012-01-01 08:00:00', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select atPeriod(ttext 'A@2012-01-01 08:00:00', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select atPeriod(ttext 'A@2012-01-01 08:00:00', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');

select atPeriod(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select atPeriod(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select atPeriod(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select atPeriod(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select atPeriod(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select atPeriod(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select atPeriod(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select atPeriod(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select atPeriod(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select atPeriod(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select atPeriod(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select atPeriod(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');

select atPeriod(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select atPeriod(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select atPeriod(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select atPeriod(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select atPeriod(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select atPeriod(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select atPeriod(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select atPeriod(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select atPeriod(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select atPeriod(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select atPeriod(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select atPeriod(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');

select atPeriod(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select atPeriod(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select atPeriod(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select atPeriod(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select atPeriod(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select atPeriod(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select atPeriod(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select atPeriod(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select atPeriod(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select atPeriod(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select atPeriod(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select atPeriod(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');

-------------------------------------------------------------------------------

select minusPeriod(tbool 'FALSE@2012-01-01 08:00:00', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select minusPeriod(tbool 'FALSE@2012-01-01 08:00:00', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select minusPeriod(tint '1@2012-01-01 08:00:00', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select minusPeriod(tint '1@2012-01-01 08:00:00', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select minusPeriod(tfloat '1@2012-01-01 08:00:00', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select minusPeriod(tfloat '1@2012-01-01 08:00:00', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select minusPeriod(ttext 'A@2012-01-01 08:00:00', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select minusPeriod(ttext 'A@2012-01-01 08:00:00', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');

select minusPeriod(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select minusPeriod(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select minusPeriod(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select minusPeriod(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select minusPeriod(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select minusPeriod(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select minusPeriod(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select minusPeriod(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select minusPeriod(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select minusPeriod(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select minusPeriod(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select minusPeriod(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');

select minusPeriod(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select minusPeriod(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select minusPeriod(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select minusPeriod(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select minusPeriod(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select minusPeriod(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select minusPeriod(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select minusPeriod(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select minusPeriod(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select minusPeriod(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select minusPeriod(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select minusPeriod(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');

select minusPeriod(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select minusPeriod(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select minusPeriod(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select minusPeriod(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select minusPeriod(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select minusPeriod(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select minusPeriod(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select minusPeriod(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select minusPeriod(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');
select minusPeriod(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '[2012-01-01 08:00:00, 2012-01-01 08:01:00]');
select minusPeriod(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '[2012-01-01 08:05:00, 2012-01-01 08:06:00]');
select minusPeriod(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '[2012-01-01 08:10:00, 2012-01-01 08:11:00]');

-------------------------------------------------------------------------------

select atPeriodSet(tbool 'FALSE@2012-01-01 08:00:00', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select atPeriodSet(tbool 'FALSE@2012-01-01 08:00:00', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select atPeriodSet(tint '1@2012-01-01 08:00:00', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select atPeriodSet(tint '1@2012-01-01 08:00:00', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select atPeriodSet(tfloat '1@2012-01-01 08:00:00', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select atPeriodSet(tfloat '1@2012-01-01 08:00:00', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select atPeriodSet(ttext 'A@2012-01-01 08:00:00', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select atPeriodSet(ttext 'A@2012-01-01 08:00:00', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');

select atPeriodSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select atPeriodSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select atPeriodSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select atPeriodSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select atPeriodSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select atPeriodSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select atPeriodSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select atPeriodSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select atPeriodSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select atPeriodSet(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select atPeriodSet(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select atPeriodSet(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');

select atPeriodSet(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select atPeriodSet(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select atPeriodSet(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select atPeriodSet(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select atPeriodSet(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select atPeriodSet(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select atPeriodSet(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select atPeriodSet(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select atPeriodSet(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select atPeriodSet(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select atPeriodSet(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select atPeriodSet(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');

select atPeriodSet(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select atPeriodSet(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select atPeriodSet(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select atPeriodSet(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select atPeriodSet(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select atPeriodSet(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select atPeriodSet(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select atPeriodSet(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select atPeriodSet(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select atPeriodSet(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select atPeriodSet(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select atPeriodSet(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');

-------------------------------------------------------------------------------

select minusPeriodSet(tbool 'FALSE@2012-01-01 08:00:00', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select minusPeriodSet(tbool 'FALSE@2012-01-01 08:00:00', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select minusPeriodSet(tint '1@2012-01-01 08:00:00', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select minusPeriodSet(tint '1@2012-01-01 08:00:00', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select minusPeriodSet(tfloat '1@2012-01-01 08:00:00', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select minusPeriodSet(tfloat '1@2012-01-01 08:00:00', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select minusPeriodSet(ttext 'A@2012-01-01 08:00:00', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select minusPeriodSet(ttext 'A@2012-01-01 08:00:00', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');

select minusPeriodSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select minusPeriodSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select minusPeriodSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select minusPeriodSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select minusPeriodSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select minusPeriodSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select minusPeriodSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select minusPeriodSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select minusPeriodSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select minusPeriodSet(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select minusPeriodSet(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select minusPeriodSet(ttext '{A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00}', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');

select minusPeriodSet(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select minusPeriodSet(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select minusPeriodSet(tbool '[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00]', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select minusPeriodSet(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select minusPeriodSet(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select minusPeriodSet(tint '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select minusPeriodSet(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select minusPeriodSet(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select minusPeriodSet(tfloat '[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00]', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select minusPeriodSet(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select minusPeriodSet(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select minusPeriodSet(ttext '[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,A@2001-01-01 08:06:00]', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');

select minusPeriodSet(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select minusPeriodSet(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select minusPeriodSet(tbool '{[true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00],
 [true@2001-01-01 09:00:00,false@2001-01-01 09:05:00,true@2001-01-01 09:06:00]}', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select minusPeriodSet(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select minusPeriodSet(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select minusPeriodSet(tint '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select minusPeriodSet(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select minusPeriodSet(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select minusPeriodSet(tfloat '{[1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00],
 [1@2001-01-01 09:00:00,2@2001-01-01 09:05:00,1@2001-01-01 09:06:00]}', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');
select minusPeriodSet(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '{[2012-01-01 08:00:00, 2012-01-01 08:01:00]}');
select minusPeriodSet(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '{[2012-01-01 08:05:00, 2012-01-01 08:06:00]}');
select minusPeriodSet(ttext '{[A@2001-01-01 08:00:00,B@2001-01-01 08:05:00,C@2001-01-01 08:06:00],
 [A@2001-01-01 09:00:00,B@2001-01-01 09:05:00,C@2001-01-01 09:06:00]}', '{[2012-01-01 08:10:00, 2012-01-01 08:11:00]}');

-------------------------------------------------------------------------------

select intersectsTimestamp(tboolinst(TRUE, '2012-01-01 08:00:00'),'2012-01-01 08:00:00');
select intersectsTimestamp(tboolinst(TRUE, '2012-01-01 08:00:00'),'2012-01-01 08:10:00');
select intersectsTimestamp(tintinst(1, '2012-01-01 08:00:00'),'2012-01-01 08:00:00');
select intersectsTimestamp(tintinst(1, '2012-01-01 08:00:00'),'2012-01-01 08:10:00');
select intersectsTimestamp(tfloatinst(1, '2012-01-01 08:00:00'),'2012-01-01 08:00:00');
select intersectsTimestamp(tfloatinst(1, '2012-01-01 08:00:00'),'2012-01-01 08:10:00');

-------------------------------------------------------------------------------

select intersectsTimestampSet(tboolinst(TRUE, '2012-01-01 08:00:00'),
	timestampset(ARRAY[timestamp '2012-01-01 08:00:00', '2012-01-01 08:05:00', '2012-01-01 08:10:00']));
select intersectsTimestampSet(tboolinst(TRUE, '2012-01-01 08:00:00'),
	timestampset(ARRAY[timestamp '2012-01-01 08:05:00', '2012-01-01 08:10:00']));
select intersectsTimestampSet(tintinst(1, '2012-01-01 08:00:00'),
	timestampset(ARRAY[timestamp '2012-01-01 08:00:00', '2012-01-01 08:05:00', '2012-01-01 08:10:00']));
select intersectsTimestampSet(tintinst(1, '2012-01-01 08:00:00'),
	timestampset(ARRAY[timestamp '2012-01-01 08:05:00', '2012-01-01 08:10:00']));
select intersectsTimestampSet(tfloatinst(1, '2012-01-01 08:00:00'),
	timestampset(ARRAY[timestamp '2012-01-01 08:00:00', '2012-01-01 08:05:00', '2012-01-01 08:10:00']));
select intersectsTimestampSet(tfloatinst(1, '2012-01-01 08:00:00'),
	timestampset(ARRAY[timestamp '2012-01-01 08:05:00', '2012-01-01 08:10:00']));

-------------------------------------------------------------------------------

select intersectsPeriod(tboolinst(true, '2012-01-01 08:00:00'), period('2012-01-01 08:00:00','2012-01-01 08:10:00'));
select intersectsPeriod(tboolinst(true, '2012-01-01 08:00:00'), period('2012-01-01 08:01:00','2012-01-01 08:10:00'));
select intersectsPeriod(tintinst(1, '2012-01-01 08:00:00'), period('2012-01-01 08:00:00','2012-01-01 08:10:00'));
select intersectsPeriod(tintinst(1, '2012-01-01 08:00:00'), period('2012-01-01 08:01:00','2012-01-01 08:10:00'));
select intersectsPeriod(tfloatinst(1, '2012-01-01 08:00:00'), period('2012-01-01 08:00:00','2012-01-01 08:10:00'));
select intersectsPeriod(tfloatinst(1, '2012-01-01 08:00:00'), period('2012-01-01 08:01:00','2012-01-01 08:10:00'));

-------------------------------------------------------------------------------

select intersectsPeriodSet(tboolinst(true, '2012-01-01 08:00:00'), 
	periodset(ARRAY[period('2012-01-01 08:00:00','2012-01-01 08:05:00'), 
	period('2012-01-01 08:06:00','2012-01-01 08:10:00')]));
select intersectsPeriodSet(tboolinst(true, '2012-01-01 08:00:00'), 
	periodset(ARRAY[period('2012-01-01 08:01:00','2012-01-01 08:05:00'), 
	period('2012-01-01 08:06:00','2012-01-01 08:10:00')]));
select intersectsPeriodSet(tintinst(1, '2012-01-01 08:00:00'), 
	periodset(ARRAY[period('2012-01-01 08:00:00','2012-01-01 08:05:00'), 
	period('2012-01-01 08:06:00','2012-01-01 08:10:00')]));
select intersectsPeriodSet(tintinst(1, '2012-01-01 08:00:00'), 
	periodset(ARRAY[period('2012-01-01 08:01:00','2012-01-01 08:05:00'), 
	period('2012-01-01 08:06:00','2012-01-01 08:10:00')]));
select intersectsPeriodSet(tfloatinst(1, '2012-01-01 08:00:00'), 
	periodset(ARRAY[period('2012-01-01 08:00:00','2012-01-01 08:05:00'), 
	period('2012-01-01 08:06:00','2012-01-01 08:10:00')]));
select intersectsPeriodSet(tfloatinst(1, '2012-01-01 08:00:00'), 
	periodset(ARRAY[period('2012-01-01 08:01:00','2012-01-01 08:05:00'), 
	period('2012-01-01 08:06:00','2012-01-01 08:10:00')]));

-------------------------------------------------------------------------------
-- Comparison functions and B-tree indexing
-------------------------------------------------------------------------------

select ttextinst('AAA', '2001-01-01 08:00:00') =
	ttextinst('AAA', '2001-01-01 08:00:00');

select ttextinst('AAA', '2001-01-01 08:00:00') <
	ttextinst('AAA', '2001-01-01 08:00:00');

WITH Values AS(
select tboolinst(true, '2012-01-01 08:00:00') AS value union
select tboolinst(false, '2012-01-01 08:00:00') union
select tboolinst(true, '2012-01-01 08:00:00') union
select tboolinst(false, '2012-01-01 08:00:00')
)
select *
from Values
order by value;

WITH Values AS(
select tboolinst(true, '2012-01-01 08:00:00') AS value union all
select tboolinst(false, '2012-01-01 08:00:00') union all
select tboolinst(true, '2012-01-01 08:00:00') union all
select tboolinst(false, '2012-01-01 08:00:00')
)
select *
from Values
order by value;

WITH Values AS(
select tintinst(1, '2012-01-01 08:00:00') AS value union
select tintinst(1, '2012-01-01 08:00:00') union
select tintinst(2, '2012-01-01 08:00:00') union
select tintinst(3, '2012-01-01 08:00:00')
)
select *
from Values
order by value;

WITH Values AS(
select tintinst(1, '2012-01-01 08:00:00') AS value union all
select tintinst(1, '2012-01-01 08:00:00') union all
select tintinst(2, '2012-01-01 08:00:00') union all
select tintinst(3, '2012-01-01 08:00:00')
)
select *
from Values
order by value;

WITH Values AS(
select tfloatinst(1, '2012-01-01 08:00:00') AS value union
select tfloatinst(1, '2012-01-01 08:00:00') union
select tfloatinst(2, '2012-01-01 08:00:00') union
select tfloatinst(3, '2012-01-01 08:00:00')
)
select *
from Values
order by value;

WITH Values AS(
select tfloatinst(1, '2012-01-01 08:00:00') AS value union all
select tfloatinst(1, '2012-01-01 08:00:00') union all
select tfloatinst(2, '2012-01-01 08:00:00') union all
select tfloatinst(3, '2012-01-01 08:00:00')
)
select *
from Values
order by value;

WITH Values AS (
select ttextinst('AAA', '2012-01-01 08:00:00') AS value union
select ttextinst('BBB', '2012-01-01 08:00:00') union
select ttextinst('AAA', '2012-01-01 08:00:00') union
select ttextinst('BBB', '2012-01-01 08:00:00')
)
select *
from Values
order by value;

------------------------------------------------------------------------------
